<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Duncan Garmonsway" />

<meta name="date" content="2017-04-23" />

<title>Compass Directions</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Compass Directions</h1>
<h4 class="author"><em>Duncan Garmonsway</em></h4>
<h4 class="date"><em>2017-04-23</em></h4>


<div id="TOC">
<ul>
<li><a href="#nnw-wnw-example">NNW WNW example</a><ul>
<li><a href="#headers">Headers</a></li>
<li><a href="#data">Data</a></li>
<li><a href="#join-headers-to-data">Join headers to data</a></li>
<li><a href="#result">Result</a></li>
</ul></li>
<li><a href="#nne-wsw-example">NNE WSW example</a><ul>
<li><a href="#headers-same-as-nnw-wnw">Headers (same as NNW WNW)</a></li>
<li><a href="#data-same-as-nnw-wnw">Data (same as NNW WNW)</a></li>
<li><a href="#join-headers-to-data-different-from-nnw-wnw">Join headers to data (different from NNW WNW)</a></li>
<li><a href="#result-1">Result</a></li>
</ul></li>
<li><a href="#sse-ese-example">SSE ESE example</a><ul>
<li><a href="#headers-1">Headers</a></li>
<li><a href="#data-1">Data</a></li>
<li><a href="#join-headers-to-data-1">Join headers to data</a></li>
<li><a href="#result-2">Result</a></li>
</ul></li>
<li><a href="#ssw-ene-example">SSW ENE example</a><ul>
<li><a href="#headers-same-as-sse-ese">Headers (same as SSE ESE)</a></li>
<li><a href="#data-same-as-sse-ese">Data (same as SSE ESE)</a></li>
<li><a href="#join-headers-to-data-2">Join headers to data</a></li>
<li><a href="#result-3">Result</a></li>
</ul></li>
<li><a href="#check-that-all-sheets-are-parsed-correctly">Check that all sheets are parsed correctly</a></li>
<li><a href="#above-left-example">ABOVE LEFT example</a><ul>
<li><a href="#headers-2">Headers</a></li>
<li><a href="#data-2">Data</a></li>
<li><a href="#join-headers-to-data-3">Join headers to data</a></li>
<li><a href="#result-4">Result</a></li>
</ul></li>
<li><a href="#below-right-example">BELOW RIGHT example</a><ul>
<li><a href="#headers-3">Headers</a></li>
<li><a href="#data-3">Data</a></li>
<li><a href="#join-headers-to-data-4">Join headers to data</a></li>
<li><a href="#result-5">Result</a></li>
</ul></li>
<li><a href="#check-that-all-sheets-are-parsed-correctly-1">Check that all sheets are parsed correctly</a></li>
<li><a href="#above-left-border-example">ABOVE LEFT border example</a><ul>
<li><a href="#headers-4">Headers</a></li>
<li><a href="#data-4">Data</a></li>
<li><a href="#borders">Borders</a></li>
<li><a href="#join-headers-to-data-5">Join headers to data</a></li>
<li><a href="#result-6">Result</a></li>
</ul></li>
<li><a href="#below-right-border-example">BELOW RIGHT border example</a><ul>
<li><a href="#headers-5">Headers</a></li>
<li><a href="#data-5">Data</a></li>
<li><a href="#borders-1">Borders</a></li>
<li><a href="#join-headers-to-data-6">Join headers to data</a></li>
<li><a href="#result-7">Result</a></li>
</ul></li>
<li><a href="#check-that-all-sheets-are-parsed-correctly-2">Check that all sheets are parsed correctly</a></li>
</ul>
</div>

<p>This vignette for the <a href="https://github.com/nacnudus/unpivotr">unpivotr</a> package demonstrates unpivoting pivot tables of various kinds imported from a spreadsheet via the <a href="https://github.com/nacnudus/tidyxl">tidyxl</a> package. It is best read with the spreadsheet open in a spreadsheet program, e.g. Excel, LibreOffice Calc or Gnumeric.</p>
<p>The spreadsheet is in the package directory at <code>../inst/extdata/purpose.xlsx</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)</code></pre></div>
<pre><code>## 
## Attaching package: 'dplyr'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyxl)
<span class="kw">library</span>(unpivotr)</code></pre></div>
<pre><code>## 
## Attaching package: 'unpivotr'</code></pre>
<pre><code>## The following object is masked from 'package:stats':
## 
##     offset</code></pre>
<div id="nnw-wnw-example" class="section level2">
<h2>NNW WNW example</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(original &lt;-<span class="st"> </span>purpose<span class="op">$</span><span class="st">`</span><span class="dt">NNW WNW</span><span class="st">`</span>)</code></pre></div>
<pre><code>##                            X2      X3     X4     X5    X6     X7
## 1                        &lt;NA&gt;    &lt;NA&gt; Female   &lt;NA&gt;  Male   &lt;NA&gt;
## 2                        &lt;NA&gt;    &lt;NA&gt;  0 - 6 7 - 10 0 - 6 7 - 10
## 3           Bachelor's degree 15 - 24   7000  27000  &lt;NA&gt;  13000
## 4                        &lt;NA&gt; 25 - 44  12000 137000  9000  81000
## 5                        &lt;NA&gt; 45 - 64  10000  64000  7000  66000
## 6                        &lt;NA&gt;     65+   &lt;NA&gt;  18000  7000  17000
## 7                 Certificate 15 - 24  29000 161000 30000 190000
## 8                        &lt;NA&gt; 25 - 44  34000 179000 31000 219000
## 9                        &lt;NA&gt; 45 - 64  30000 210000 23000 199000
## 10                       &lt;NA&gt;     65+  12000  77000  8000 107000
## 11                    Diploma 15 - 24   &lt;NA&gt;  14000  9000  11000
## 12                       &lt;NA&gt; 25 - 44  10000  66000  8000  47000
## 13                       &lt;NA&gt; 45 - 64   6000  68000  5000  58000
## 14                       &lt;NA&gt;     65+   5000  41000  1000  34000
## 15           No Qualification 15 - 24  10000  43000 12000  37000
## 16                       &lt;NA&gt; 25 - 44  11000  36000 21000  50000
## 17                       &lt;NA&gt; 45 - 64  19000  91000 17000  75000
## 18                       &lt;NA&gt;     65+  16000 118000  9000  66000
## 19 Postgraduate qualification 15 - 24   &lt;NA&gt;   6000  &lt;NA&gt;   &lt;NA&gt;
## 20                       &lt;NA&gt; 25 - 44   5000  86000  7000  60000
## 21                       &lt;NA&gt; 45 - 64   6000  55000  6000  68000
## 22                       &lt;NA&gt;     65+   &lt;NA&gt;  13000  &lt;NA&gt;  18000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(cells &lt;-<span class="st"> </span><span class="kw">tidytable</span>(original, <span class="dt">colnames =</span> <span class="ot">FALSE</span>))</code></pre></div>
<pre><code>##     row col character double integer logical
## 127  17   6     75000     NA      NA      NA
## 128  18   6     66000     NA      NA      NA
## 129  19   6      &lt;NA&gt;     NA      NA      NA
## 130  20   6     60000     NA      NA      NA
## 131  21   6     68000     NA      NA      NA
## 132  22   6     18000     NA      NA      NA</code></pre>
<div id="headers" class="section level3">
<h3>Headers</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">row_headers &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="op">!</span><span class="kw">is.na</span>(character)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Select all rows of headers at once</span>
<span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col) <span class="co"># Return each row of headers in its own element of a list</span>
row_headers</code></pre></div>
<pre><code>## $`1`
##   row col                     header
## 1   3   1          Bachelor's degree
## 2   7   1                Certificate
## 3  11   1                    Diploma
## 4  15   1           No Qualification
## 5  19   1 Postgraduate qualification
## 
## $`2`
##    row col  header
## 6    3   2 15 - 24
## 7    4   2 25 - 44
## 8    5   2 45 - 64
## 9    6   2     65+
## 10   7   2 15 - 24
## 11   8   2 25 - 44
## 12   9   2 45 - 64
## 13  10   2     65+
## 14  11   2 15 - 24
## 15  12   2 25 - 44
## 16  13   2 45 - 64
## 17  14   2     65+
## 18  15   2 15 - 24
## 19  16   2 25 - 44
## 20  17   2 45 - 64
## 21  18   2     65+
## 22  19   2 15 - 24
## 23  20   2 25 - 44
## 24  21   2 45 - 64
## 25  22   2     65+</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">col_headers &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="op">!</span><span class="kw">is.na</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)
col_headers</code></pre></div>
<pre><code>## $`1`
##   row col header
## 1   1   3 Female
## 4   1   5   Male
## 
## $`2`
##   row col header
## 2   2   3  0 - 6
## 3   2   4 7 - 10
## 5   2   5  0 - 6
## 6   2   6 7 - 10</code></pre>
</div>
<div id="data" class="section level3">
<h3>Data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, <span class="op">!</span><span class="kw">is.na</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, value)
<span class="kw">head</span>(datacells)</code></pre></div>
<pre><code>##   row col value
## 1   3   3  7000
## 2   4   3 12000
## 3   5   3 10000
## 4   7   3 29000
## 5   8   3 34000
## 6   9   3 30000</code></pre>
</div>
<div id="join-headers-to-data" class="section level3">
<h3>Join headers to data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells &lt;-
<span class="st">  </span>datacells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">NNW</span>(col_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">N</span>(col_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">WNW</span>(row_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">W</span>(row_headers[[<span class="dv">2</span>]])</code></pre></div>
</div>
<div id="result" class="section level3">
<h3>Result</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</code></pre></div>
<pre><code>##    row col  value header.data header.header           header.data.data
## 1    3   3   7000      Female         0 - 6          Bachelor's degree
## 2    4   3  12000      Female         0 - 6          Bachelor's degree
## 3    5   3  10000      Female         0 - 6          Bachelor's degree
## 4    7   3  29000      Female         0 - 6                Certificate
## 5    8   3  34000      Female         0 - 6                Certificate
## 6    9   3  30000      Female         0 - 6                Certificate
## 7   10   3  12000      Female         0 - 6                Certificate
## 8   12   3  10000      Female         0 - 6                    Diploma
## 9   13   3   6000      Female         0 - 6                    Diploma
## 10  14   3   5000      Female         0 - 6                    Diploma
## 11  15   3  10000      Female         0 - 6           No Qualification
## 12  16   3  11000      Female         0 - 6           No Qualification
## 13  17   3  19000      Female         0 - 6           No Qualification
## 14  18   3  16000      Female         0 - 6           No Qualification
## 15  20   3   5000      Female         0 - 6 Postgraduate qualification
## 16  21   3   6000      Female         0 - 6 Postgraduate qualification
## 17   3   4  27000      Female        7 - 10          Bachelor's degree
## 18   4   4 137000      Female        7 - 10          Bachelor's degree
## 19   5   4  64000      Female        7 - 10          Bachelor's degree
## 20   6   4  18000      Female        7 - 10          Bachelor's degree
## 21   7   4 161000      Female        7 - 10                Certificate
## 22   8   4 179000      Female        7 - 10                Certificate
## 23   9   4 210000      Female        7 - 10                Certificate
## 24  10   4  77000      Female        7 - 10                Certificate
## 25  11   4  14000      Female        7 - 10                    Diploma
## 26  12   4  66000      Female        7 - 10                    Diploma
## 27  13   4  68000      Female        7 - 10                    Diploma
## 28  14   4  41000      Female        7 - 10                    Diploma
## 29  15   4  43000      Female        7 - 10           No Qualification
## 30  16   4  36000      Female        7 - 10           No Qualification
## 31  17   4  91000      Female        7 - 10           No Qualification
## 32  18   4 118000      Female        7 - 10           No Qualification
## 33  19   4   6000      Female        7 - 10 Postgraduate qualification
## 34  20   4  86000      Female        7 - 10 Postgraduate qualification
## 35  21   4  55000      Female        7 - 10 Postgraduate qualification
## 36  22   4  13000      Female        7 - 10 Postgraduate qualification
## 37   4   5   9000        Male         0 - 6          Bachelor's degree
## 38   5   5   7000        Male         0 - 6          Bachelor's degree
## 39   6   5   7000        Male         0 - 6          Bachelor's degree
## 40   7   5  30000        Male         0 - 6                Certificate
## 41   8   5  31000        Male         0 - 6                Certificate
## 42   9   5  23000        Male         0 - 6                Certificate
## 43  10   5   8000        Male         0 - 6                Certificate
## 44  11   5   9000        Male         0 - 6                    Diploma
## 45  12   5   8000        Male         0 - 6                    Diploma
## 46  13   5   5000        Male         0 - 6                    Diploma
## 47  14   5   1000        Male         0 - 6                    Diploma
## 48  15   5  12000        Male         0 - 6           No Qualification
## 49  16   5  21000        Male         0 - 6           No Qualification
## 50  17   5  17000        Male         0 - 6           No Qualification
## 51  18   5   9000        Male         0 - 6           No Qualification
## 52  20   5   7000        Male         0 - 6 Postgraduate qualification
## 53  21   5   6000        Male         0 - 6 Postgraduate qualification
## 54   3   6  13000        Male        7 - 10          Bachelor's degree
## 55   4   6  81000        Male        7 - 10          Bachelor's degree
## 56   5   6  66000        Male        7 - 10          Bachelor's degree
## 57   6   6  17000        Male        7 - 10          Bachelor's degree
## 58   7   6 190000        Male        7 - 10                Certificate
## 59   8   6 219000        Male        7 - 10                Certificate
## 60   9   6 199000        Male        7 - 10                Certificate
## 61  10   6 107000        Male        7 - 10                Certificate
## 62  11   6  11000        Male        7 - 10                    Diploma
## 63  12   6  47000        Male        7 - 10                    Diploma
## 64  13   6  58000        Male        7 - 10                    Diploma
## 65  14   6  34000        Male        7 - 10                    Diploma
## 66  15   6  37000        Male        7 - 10           No Qualification
## 67  16   6  50000        Male        7 - 10           No Qualification
## 68  17   6  75000        Male        7 - 10           No Qualification
## 69  18   6  66000        Male        7 - 10           No Qualification
## 70  20   6  60000        Male        7 - 10 Postgraduate qualification
## 71  21   6  68000        Male        7 - 10 Postgraduate qualification
## 72  22   6  18000        Male        7 - 10 Postgraduate qualification
##    header.header.header
## 1               15 - 24
## 2               25 - 44
## 3               45 - 64
## 4               15 - 24
## 5               25 - 44
## 6               45 - 64
## 7                   65+
## 8               25 - 44
## 9               45 - 64
## 10                  65+
## 11              15 - 24
## 12              25 - 44
## 13              45 - 64
## 14                  65+
## 15              25 - 44
## 16              45 - 64
## 17              15 - 24
## 18              25 - 44
## 19              45 - 64
## 20                  65+
## 21              15 - 24
## 22              25 - 44
## 23              45 - 64
## 24                  65+
## 25              15 - 24
## 26              25 - 44
## 27              45 - 64
## 28                  65+
## 29              15 - 24
## 30              25 - 44
## 31              45 - 64
## 32                  65+
## 33              15 - 24
## 34              25 - 44
## 35              45 - 64
## 36                  65+
## 37              25 - 44
## 38              45 - 64
## 39                  65+
## 40              15 - 24
## 41              25 - 44
## 42              45 - 64
## 43                  65+
## 44              15 - 24
## 45              25 - 44
## 46              45 - 64
## 47                  65+
## 48              15 - 24
## 49              25 - 44
## 50              45 - 64
## 51                  65+
## 52              25 - 44
## 53              45 - 64
## 54              15 - 24
## 55              25 - 44
## 56              45 - 64
## 57                  65+
## 58              15 - 24
## 59              25 - 44
## 60              45 - 64
## 61                  65+
## 62              15 - 24
## 63              25 - 44
## 64              45 - 64
## 65                  65+
## 66              15 - 24
## 67              25 - 44
## 68              45 - 64
## 69                  65+
## 70              25 - 44
## 71              45 - 64
## 72                  65+</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">NNW_WNW &lt;-<span class="st"> </span>datacells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(row, col)</code></pre></div>
</div>
</div>
<div id="nne-wsw-example" class="section level2">
<h2>NNE WSW example</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cells &lt;-<span class="st"> </span><span class="kw">tidytable</span>(purpose<span class="op">$</span><span class="st">`</span><span class="dt">NNE WSW</span><span class="st">`</span>, <span class="dt">colnames =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div id="headers-same-as-nnw-wnw" class="section level3">
<h3>Headers (same as NNW WNW)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">row_headers &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="op">!</span><span class="kw">is.na</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)
row_headers</code></pre></div>
<pre><code>## $`1`
##   row col                     header
## 1   6   1          Bachelor's degree
## 2  10   1                Certificate
## 3  14   1                    Diploma
## 4  18   1           No Qualification
## 5  22   1 Postgraduate qualification
## 
## $`2`
##    row col  header
## 6    3   2 15 - 24
## 7    4   2 25 - 44
## 8    5   2 45 - 64
## 9    6   2     65+
## 10   7   2 15 - 24
## 11   8   2 25 - 44
## 12   9   2 45 - 64
## 13  10   2     65+
## 14  11   2 15 - 24
## 15  12   2 25 - 44
## 16  13   2 45 - 64
## 17  14   2     65+
## 18  15   2 15 - 24
## 19  16   2 25 - 44
## 20  17   2 45 - 64
## 21  18   2     65+
## 22  19   2 15 - 24
## 23  20   2 25 - 44
## 24  21   2 45 - 64
## 25  22   2     65+</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">col_headers &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="op">!</span><span class="kw">is.na</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)
col_headers</code></pre></div>
<pre><code>## $`1`
##   row col header
## 2   1   4 Female
## 5   1   6   Male
## 
## $`2`
##   row col header
## 1   2   3  0 - 6
## 3   2   4 7 - 10
## 4   2   5  0 - 6
## 6   2   6 7 - 10</code></pre>
</div>
<div id="data-same-as-nnw-wnw" class="section level3">
<h3>Data (same as NNW WNW)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, <span class="op">!</span><span class="kw">is.na</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, value)
datacells</code></pre></div>
<pre><code>##    row col  value
## 1    3   3   7000
## 2    4   3  12000
## 3    5   3  10000
## 4    7   3  29000
## 5    8   3  34000
## 6    9   3  30000
## 7   10   3  12000
## 8   12   3  10000
## 9   13   3   6000
## 10  14   3   5000
## 11  15   3  10000
## 12  16   3  11000
## 13  17   3  19000
## 14  18   3  16000
## 15  20   3   5000
## 16  21   3   6000
## 17   3   4  27000
## 18   4   4 137000
## 19   5   4  64000
## 20   6   4  18000
## 21   7   4 161000
## 22   8   4 179000
## 23   9   4 210000
## 24  10   4  77000
## 25  11   4  14000
## 26  12   4  66000
## 27  13   4  68000
## 28  14   4  41000
## 29  15   4  43000
## 30  16   4  36000
## 31  17   4  91000
## 32  18   4 118000
## 33  19   4   6000
## 34  20   4  86000
## 35  21   4  55000
## 36  22   4  13000
## 37   4   5   9000
## 38   5   5   7000
## 39   6   5   7000
## 40   7   5  30000
## 41   8   5  31000
## 42   9   5  23000
## 43  10   5   8000
## 44  11   5   9000
## 45  12   5   8000
## 46  13   5   5000
## 47  14   5   1000
## 48  15   5  12000
## 49  16   5  21000
## 50  17   5  17000
## 51  18   5   9000
## 52  20   5   7000
## 53  21   5   6000
## 54   3   6  13000
## 55   4   6  81000
## 56   5   6  66000
## 57   6   6  17000
## 58   7   6 190000
## 59   8   6 219000
## 60   9   6 199000
## 61  10   6 107000
## 62  11   6  11000
## 63  12   6  47000
## 64  13   6  58000
## 65  14   6  34000
## 66  15   6  37000
## 67  16   6  50000
## 68  17   6  75000
## 69  18   6  66000
## 70  20   6  60000
## 71  21   6  68000
## 72  22   6  18000</code></pre>
</div>
<div id="join-headers-to-data-different-from-nnw-wnw" class="section level3">
<h3>Join headers to data (different from NNW WNW)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells &lt;-
<span class="st">  </span>datacells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">NNE</span>(col_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from NNW WNW</span>
<span class="st">  </span><span class="kw">N</span>(col_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Same as NNW WNW</span>
<span class="st">  </span><span class="kw">WSW</span>(row_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from NNW WNW</span>
<span class="st">  </span><span class="kw">W</span>(row_headers[[<span class="dv">2</span>]]) <span class="co"># Same as NNW WNW</span></code></pre></div>
</div>
<div id="result-1" class="section level3">
<h3>Result</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</code></pre></div>
<pre><code>##    row col  value header.data header.header           header.data.data
## 1    3   3   7000      Female         0 - 6          Bachelor's degree
## 2    4   3  12000      Female         0 - 6          Bachelor's degree
## 3    5   3  10000      Female         0 - 6          Bachelor's degree
## 4    7   3  29000      Female         0 - 6                Certificate
## 5    8   3  34000      Female         0 - 6                Certificate
## 6    9   3  30000      Female         0 - 6                Certificate
## 7   10   3  12000      Female         0 - 6                Certificate
## 8   12   3  10000      Female         0 - 6                    Diploma
## 9   13   3   6000      Female         0 - 6                    Diploma
## 10  14   3   5000      Female         0 - 6                    Diploma
## 11  15   3  10000      Female         0 - 6           No Qualification
## 12  16   3  11000      Female         0 - 6           No Qualification
## 13  17   3  19000      Female         0 - 6           No Qualification
## 14  18   3  16000      Female         0 - 6           No Qualification
## 15  20   3   5000      Female         0 - 6 Postgraduate qualification
## 16  21   3   6000      Female         0 - 6 Postgraduate qualification
## 17   3   4  27000      Female        7 - 10          Bachelor's degree
## 18   4   4 137000      Female        7 - 10          Bachelor's degree
## 19   5   4  64000      Female        7 - 10          Bachelor's degree
## 20   6   4  18000      Female        7 - 10          Bachelor's degree
## 21   7   4 161000      Female        7 - 10                Certificate
## 22   8   4 179000      Female        7 - 10                Certificate
## 23   9   4 210000      Female        7 - 10                Certificate
## 24  10   4  77000      Female        7 - 10                Certificate
## 25  11   4  14000      Female        7 - 10                    Diploma
## 26  12   4  66000      Female        7 - 10                    Diploma
## 27  13   4  68000      Female        7 - 10                    Diploma
## 28  14   4  41000      Female        7 - 10                    Diploma
## 29  15   4  43000      Female        7 - 10           No Qualification
## 30  16   4  36000      Female        7 - 10           No Qualification
## 31  17   4  91000      Female        7 - 10           No Qualification
## 32  18   4 118000      Female        7 - 10           No Qualification
## 33  19   4   6000      Female        7 - 10 Postgraduate qualification
## 34  20   4  86000      Female        7 - 10 Postgraduate qualification
## 35  21   4  55000      Female        7 - 10 Postgraduate qualification
## 36  22   4  13000      Female        7 - 10 Postgraduate qualification
## 37   4   5   9000        Male         0 - 6          Bachelor's degree
## 38   5   5   7000        Male         0 - 6          Bachelor's degree
## 39   6   5   7000        Male         0 - 6          Bachelor's degree
## 40   7   5  30000        Male         0 - 6                Certificate
## 41   8   5  31000        Male         0 - 6                Certificate
## 42   9   5  23000        Male         0 - 6                Certificate
## 43  10   5   8000        Male         0 - 6                Certificate
## 44  11   5   9000        Male         0 - 6                    Diploma
## 45  12   5   8000        Male         0 - 6                    Diploma
## 46  13   5   5000        Male         0 - 6                    Diploma
## 47  14   5   1000        Male         0 - 6                    Diploma
## 48  15   5  12000        Male         0 - 6           No Qualification
## 49  16   5  21000        Male         0 - 6           No Qualification
## 50  17   5  17000        Male         0 - 6           No Qualification
## 51  18   5   9000        Male         0 - 6           No Qualification
## 52  20   5   7000        Male         0 - 6 Postgraduate qualification
## 53  21   5   6000        Male         0 - 6 Postgraduate qualification
## 54   3   6  13000        Male        7 - 10          Bachelor's degree
## 55   4   6  81000        Male        7 - 10          Bachelor's degree
## 56   5   6  66000        Male        7 - 10          Bachelor's degree
## 57   6   6  17000        Male        7 - 10          Bachelor's degree
## 58   7   6 190000        Male        7 - 10                Certificate
## 59   8   6 219000        Male        7 - 10                Certificate
## 60   9   6 199000        Male        7 - 10                Certificate
## 61  10   6 107000        Male        7 - 10                Certificate
## 62  11   6  11000        Male        7 - 10                    Diploma
## 63  12   6  47000        Male        7 - 10                    Diploma
## 64  13   6  58000        Male        7 - 10                    Diploma
## 65  14   6  34000        Male        7 - 10                    Diploma
## 66  15   6  37000        Male        7 - 10           No Qualification
## 67  16   6  50000        Male        7 - 10           No Qualification
## 68  17   6  75000        Male        7 - 10           No Qualification
## 69  18   6  66000        Male        7 - 10           No Qualification
## 70  20   6  60000        Male        7 - 10 Postgraduate qualification
## 71  21   6  68000        Male        7 - 10 Postgraduate qualification
## 72  22   6  18000        Male        7 - 10 Postgraduate qualification
##    header.header.header
## 1               15 - 24
## 2               25 - 44
## 3               45 - 64
## 4               15 - 24
## 5               25 - 44
## 6               45 - 64
## 7                   65+
## 8               25 - 44
## 9               45 - 64
## 10                  65+
## 11              15 - 24
## 12              25 - 44
## 13              45 - 64
## 14                  65+
## 15              25 - 44
## 16              45 - 64
## 17              15 - 24
## 18              25 - 44
## 19              45 - 64
## 20                  65+
## 21              15 - 24
## 22              25 - 44
## 23              45 - 64
## 24                  65+
## 25              15 - 24
## 26              25 - 44
## 27              45 - 64
## 28                  65+
## 29              15 - 24
## 30              25 - 44
## 31              45 - 64
## 32                  65+
## 33              15 - 24
## 34              25 - 44
## 35              45 - 64
## 36                  65+
## 37              25 - 44
## 38              45 - 64
## 39                  65+
## 40              15 - 24
## 41              25 - 44
## 42              45 - 64
## 43                  65+
## 44              15 - 24
## 45              25 - 44
## 46              45 - 64
## 47                  65+
## 48              15 - 24
## 49              25 - 44
## 50              45 - 64
## 51                  65+
## 52              25 - 44
## 53              45 - 64
## 54              15 - 24
## 55              25 - 44
## 56              45 - 64
## 57                  65+
## 58              15 - 24
## 59              25 - 44
## 60              45 - 64
## 61                  65+
## 62              15 - 24
## 63              25 - 44
## 64              45 - 64
## 65                  65+
## 66              15 - 24
## 67              25 - 44
## 68              45 - 64
## 69                  65+
## 70              25 - 44
## 71              45 - 64
## 72                  65+</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">NNE_WSW &lt;-<span class="st"> </span>datacells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(row, col)</code></pre></div>
</div>
</div>
<div id="sse-ese-example" class="section level2">
<h2>SSE ESE example</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cells &lt;-<span class="st"> </span><span class="kw">tidytable</span>(purpose<span class="op">$</span><span class="st">`</span><span class="dt">SSE ESE</span><span class="st">`</span>, <span class="dt">colnames =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div id="headers-1" class="section level3">
<h3>Headers</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">row_headers &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span>, <span class="op">!</span><span class="kw">is.na</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)
row_headers</code></pre></div>
<pre><code>## $`5`
##    row col  header
## 1    1   5 15 - 24
## 2    2   5 25 - 44
## 3    3   5 45 - 64
## 4    4   5     65+
## 5    5   5 15 - 24
## 6    6   5 25 - 44
## 7    7   5 45 - 64
## 8    8   5     65+
## 9    9   5 15 - 24
## 10  10   5 25 - 44
## 11  11   5 45 - 64
## 12  12   5     65+
## 13  13   5 15 - 24
## 14  14   5 25 - 44
## 15  15   5 45 - 64
## 16  16   5     65+
## 17  17   5 15 - 24
## 18  18   5 25 - 44
## 19  19   5 45 - 64
## 20  20   5     65+
## 
## $`6`
##    row col                     header
## 21   4   6          Bachelor's degree
## 22   8   6                Certificate
## 23  12   6                    Diploma
## 24  16   6           No Qualification
## 25  20   6 Postgraduate qualification</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">col_headers &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">21</span>, <span class="op">!</span><span class="kw">is.na</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)
col_headers</code></pre></div>
<pre><code>## $`21`
##   row col header
## 1  21   1  0 - 6
## 2  21   2 7 - 10
## 4  21   3  0 - 6
## 5  21   4 7 - 10
## 
## $`22`
##   row col header
## 3  22   2 Female
## 6  22   4   Male</code></pre>
</div>
<div id="data-1" class="section level3">
<h3>Data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">20</span>, col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">4</span>, <span class="op">!</span><span class="kw">is.na</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, value)
datacells</code></pre></div>
<pre><code>##    row col  value
## 1    1   1   7000
## 2    2   1  12000
## 3    3   1  10000
## 4    5   1  29000
## 5    6   1  34000
## 6    7   1  30000
## 7    8   1  12000
## 8   10   1  10000
## 9   11   1   6000
## 10  12   1   5000
## 11  13   1  10000
## 12  14   1  11000
## 13  15   1  19000
## 14  16   1  16000
## 15  18   1   5000
## 16  19   1   6000
## 17   1   2  27000
## 18   2   2 137000
## 19   3   2  64000
## 20   4   2  18000
## 21   5   2 161000
## 22   6   2 179000
## 23   7   2 210000
## 24   8   2  77000
## 25   9   2  14000
## 26  10   2  66000
## 27  11   2  68000
## 28  12   2  41000
## 29  13   2  43000
## 30  14   2  36000
## 31  15   2  91000
## 32  16   2 118000
## 33  17   2   6000
## 34  18   2  86000
## 35  19   2  55000
## 36  20   2  13000
## 37   2   3   9000
## 38   3   3   7000
## 39   4   3   7000
## 40   5   3  30000
## 41   6   3  31000
## 42   7   3  23000
## 43   8   3   8000
## 44   9   3   9000
## 45  10   3   8000
## 46  11   3   5000
## 47  12   3   1000
## 48  13   3  12000
## 49  14   3  21000
## 50  15   3  17000
## 51  16   3   9000
## 52  18   3   7000
## 53  19   3   6000
## 54   1   4  13000
## 55   2   4  81000
## 56   3   4  66000
## 57   4   4  17000
## 58   5   4 190000
## 59   6   4 219000
## 60   7   4 199000
## 61   8   4 107000
## 62   9   4  11000
## 63  10   4  47000
## 64  11   4  58000
## 65  12   4  34000
## 66  13   4  37000
## 67  14   4  50000
## 68  15   4  75000
## 69  16   4  66000
## 70  18   4  60000
## 71  19   4  68000
## 72  20   4  18000</code></pre>
</div>
<div id="join-headers-to-data-1" class="section level3">
<h3>Join headers to data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells &lt;-
<span class="st">  </span>datacells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">SSE</span>(col_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">S</span>(col_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ESE</span>(row_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">E</span>(row_headers[[<span class="dv">1</span>]])</code></pre></div>
</div>
<div id="result-2" class="section level3">
<h3>Result</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</code></pre></div>
<pre><code>##    row col  value header.data header.header           header.data.data
## 1    1   1   7000      Female         0 - 6          Bachelor's degree
## 2    2   1  12000      Female         0 - 6          Bachelor's degree
## 3    3   1  10000      Female         0 - 6          Bachelor's degree
## 4    5   1  29000      Female         0 - 6                Certificate
## 5    6   1  34000      Female         0 - 6                Certificate
## 6    7   1  30000      Female         0 - 6                Certificate
## 7    8   1  12000      Female         0 - 6                Certificate
## 8   10   1  10000      Female         0 - 6                    Diploma
## 9   11   1   6000      Female         0 - 6                    Diploma
## 10  12   1   5000      Female         0 - 6                    Diploma
## 11  13   1  10000      Female         0 - 6           No Qualification
## 12  14   1  11000      Female         0 - 6           No Qualification
## 13  15   1  19000      Female         0 - 6           No Qualification
## 14  16   1  16000      Female         0 - 6           No Qualification
## 15  18   1   5000      Female         0 - 6 Postgraduate qualification
## 16  19   1   6000      Female         0 - 6 Postgraduate qualification
## 17   1   2  27000      Female        7 - 10          Bachelor's degree
## 18   2   2 137000      Female        7 - 10          Bachelor's degree
## 19   3   2  64000      Female        7 - 10          Bachelor's degree
## 20   4   2  18000      Female        7 - 10          Bachelor's degree
## 21   5   2 161000      Female        7 - 10                Certificate
## 22   6   2 179000      Female        7 - 10                Certificate
## 23   7   2 210000      Female        7 - 10                Certificate
## 24   8   2  77000      Female        7 - 10                Certificate
## 25   9   2  14000      Female        7 - 10                    Diploma
## 26  10   2  66000      Female        7 - 10                    Diploma
## 27  11   2  68000      Female        7 - 10                    Diploma
## 28  12   2  41000      Female        7 - 10                    Diploma
## 29  13   2  43000      Female        7 - 10           No Qualification
## 30  14   2  36000      Female        7 - 10           No Qualification
## 31  15   2  91000      Female        7 - 10           No Qualification
## 32  16   2 118000      Female        7 - 10           No Qualification
## 33  17   2   6000      Female        7 - 10 Postgraduate qualification
## 34  18   2  86000      Female        7 - 10 Postgraduate qualification
## 35  19   2  55000      Female        7 - 10 Postgraduate qualification
## 36  20   2  13000      Female        7 - 10 Postgraduate qualification
## 37   2   3   9000        Male         0 - 6          Bachelor's degree
## 38   3   3   7000        Male         0 - 6          Bachelor's degree
## 39   4   3   7000        Male         0 - 6          Bachelor's degree
## 40   5   3  30000        Male         0 - 6                Certificate
## 41   6   3  31000        Male         0 - 6                Certificate
## 42   7   3  23000        Male         0 - 6                Certificate
## 43   8   3   8000        Male         0 - 6                Certificate
## 44   9   3   9000        Male         0 - 6                    Diploma
## 45  10   3   8000        Male         0 - 6                    Diploma
## 46  11   3   5000        Male         0 - 6                    Diploma
## 47  12   3   1000        Male         0 - 6                    Diploma
## 48  13   3  12000        Male         0 - 6           No Qualification
## 49  14   3  21000        Male         0 - 6           No Qualification
## 50  15   3  17000        Male         0 - 6           No Qualification
## 51  16   3   9000        Male         0 - 6           No Qualification
## 52  18   3   7000        Male         0 - 6 Postgraduate qualification
## 53  19   3   6000        Male         0 - 6 Postgraduate qualification
## 54   1   4  13000        Male        7 - 10          Bachelor's degree
## 55   2   4  81000        Male        7 - 10          Bachelor's degree
## 56   3   4  66000        Male        7 - 10          Bachelor's degree
## 57   4   4  17000        Male        7 - 10          Bachelor's degree
## 58   5   4 190000        Male        7 - 10                Certificate
## 59   6   4 219000        Male        7 - 10                Certificate
## 60   7   4 199000        Male        7 - 10                Certificate
## 61   8   4 107000        Male        7 - 10                Certificate
## 62   9   4  11000        Male        7 - 10                    Diploma
## 63  10   4  47000        Male        7 - 10                    Diploma
## 64  11   4  58000        Male        7 - 10                    Diploma
## 65  12   4  34000        Male        7 - 10                    Diploma
## 66  13   4  37000        Male        7 - 10           No Qualification
## 67  14   4  50000        Male        7 - 10           No Qualification
## 68  15   4  75000        Male        7 - 10           No Qualification
## 69  16   4  66000        Male        7 - 10           No Qualification
## 70  18   4  60000        Male        7 - 10 Postgraduate qualification
## 71  19   4  68000        Male        7 - 10 Postgraduate qualification
## 72  20   4  18000        Male        7 - 10 Postgraduate qualification
##    header.header.header
## 1               15 - 24
## 2               25 - 44
## 3               45 - 64
## 4               15 - 24
## 5               25 - 44
## 6               45 - 64
## 7                   65+
## 8               25 - 44
## 9               45 - 64
## 10                  65+
## 11              15 - 24
## 12              25 - 44
## 13              45 - 64
## 14                  65+
## 15              25 - 44
## 16              45 - 64
## 17              15 - 24
## 18              25 - 44
## 19              45 - 64
## 20                  65+
## 21              15 - 24
## 22              25 - 44
## 23              45 - 64
## 24                  65+
## 25              15 - 24
## 26              25 - 44
## 27              45 - 64
## 28                  65+
## 29              15 - 24
## 30              25 - 44
## 31              45 - 64
## 32                  65+
## 33              15 - 24
## 34              25 - 44
## 35              45 - 64
## 36                  65+
## 37              25 - 44
## 38              45 - 64
## 39                  65+
## 40              15 - 24
## 41              25 - 44
## 42              45 - 64
## 43                  65+
## 44              15 - 24
## 45              25 - 44
## 46              45 - 64
## 47                  65+
## 48              15 - 24
## 49              25 - 44
## 50              45 - 64
## 51                  65+
## 52              25 - 44
## 53              45 - 64
## 54              15 - 24
## 55              25 - 44
## 56              45 - 64
## 57                  65+
## 58              15 - 24
## 59              25 - 44
## 60              45 - 64
## 61                  65+
## 62              15 - 24
## 63              25 - 44
## 64              45 - 64
## 65                  65+
## 66              15 - 24
## 67              25 - 44
## 68              45 - 64
## 69                  65+
## 70              25 - 44
## 71              45 - 64
## 72                  65+</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">SSE_ESE &lt;-<span class="st"> </span>datacells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(row, col)</code></pre></div>
</div>
</div>
<div id="ssw-ene-example" class="section level2">
<h2>SSW ENE example</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cells &lt;-<span class="st"> </span><span class="kw">tidytable</span>(purpose<span class="op">$</span><span class="st">`</span><span class="dt">SSW ENE</span><span class="st">`</span>, <span class="dt">colnames =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div id="headers-same-as-sse-ese" class="section level3">
<h3>Headers (same as SSE ESE)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">row_headers &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span>, <span class="op">!</span><span class="kw">is.na</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)
row_headers</code></pre></div>
<pre><code>## $`5`
##    row col  header
## 1    1   5 15 - 24
## 2    2   5 25 - 44
## 3    3   5 45 - 64
## 4    4   5     65+
## 5    5   5 15 - 24
## 6    6   5 25 - 44
## 7    7   5 45 - 64
## 8    8   5     65+
## 9    9   5 15 - 24
## 10  10   5 25 - 44
## 11  11   5 45 - 64
## 12  12   5     65+
## 13  13   5 15 - 24
## 14  14   5 25 - 44
## 15  15   5 45 - 64
## 16  16   5     65+
## 17  17   5 15 - 24
## 18  18   5 25 - 44
## 19  19   5 45 - 64
## 20  20   5     65+
## 
## $`6`
##    row col                     header
## 21   1   6          Bachelor's degree
## 22   5   6                Certificate
## 23   9   6                    Diploma
## 24  13   6           No Qualification
## 25  17   6 Postgraduate qualification</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">col_headers &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">21</span>, <span class="op">!</span><span class="kw">is.na</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)
col_headers</code></pre></div>
<pre><code>## $`21`
##   row col header
## 1  21   1  0 - 6
## 3  21   2 7 - 10
## 4  21   3  0 - 6
## 6  21   4 7 - 10
## 
## $`22`
##   row col header
## 2  22   1 Female
## 5  22   3   Male</code></pre>
</div>
<div id="data-same-as-sse-ese" class="section level3">
<h3>Data (same as SSE ESE)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">20</span>, col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">4</span>, <span class="op">!</span><span class="kw">is.na</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, value)
datacells</code></pre></div>
<pre><code>##    row col  value
## 1    1   1   7000
## 2    2   1  12000
## 3    3   1  10000
## 4    5   1  29000
## 5    6   1  34000
## 6    7   1  30000
## 7    8   1  12000
## 8   10   1  10000
## 9   11   1   6000
## 10  12   1   5000
## 11  13   1  10000
## 12  14   1  11000
## 13  15   1  19000
## 14  16   1  16000
## 15  18   1   5000
## 16  19   1   6000
## 17   1   2  27000
## 18   2   2 137000
## 19   3   2  64000
## 20   4   2  18000
## 21   5   2 161000
## 22   6   2 179000
## 23   7   2 210000
## 24   8   2  77000
## 25   9   2  14000
## 26  10   2  66000
## 27  11   2  68000
## 28  12   2  41000
## 29  13   2  43000
## 30  14   2  36000
## 31  15   2  91000
## 32  16   2 118000
## 33  17   2   6000
## 34  18   2  86000
## 35  19   2  55000
## 36  20   2  13000
## 37   2   3   9000
## 38   3   3   7000
## 39   4   3   7000
## 40   5   3  30000
## 41   6   3  31000
## 42   7   3  23000
## 43   8   3   8000
## 44   9   3   9000
## 45  10   3   8000
## 46  11   3   5000
## 47  12   3   1000
## 48  13   3  12000
## 49  14   3  21000
## 50  15   3  17000
## 51  16   3   9000
## 52  18   3   7000
## 53  19   3   6000
## 54   1   4  13000
## 55   2   4  81000
## 56   3   4  66000
## 57   4   4  17000
## 58   5   4 190000
## 59   6   4 219000
## 60   7   4 199000
## 61   8   4 107000
## 62   9   4  11000
## 63  10   4  47000
## 64  11   4  58000
## 65  12   4  34000
## 66  13   4  37000
## 67  14   4  50000
## 68  15   4  75000
## 69  16   4  66000
## 70  18   4  60000
## 71  19   4  68000
## 72  20   4  18000</code></pre>
</div>
<div id="join-headers-to-data-2" class="section level3">
<h3>Join headers to data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells &lt;-
<span class="st">  </span>datacells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">SSW</span>(col_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from SSE ESE</span>
<span class="st">  </span><span class="kw">S</span>(col_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Same as SSE ESE</span>
<span class="st">  </span><span class="kw">ENE</span>(row_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from SSE ESE</span>
<span class="st">  </span><span class="kw">E</span>(row_headers[[<span class="dv">1</span>]]) <span class="co"># Same as SSE ESE</span></code></pre></div>
</div>
<div id="result-3" class="section level3">
<h3>Result</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</code></pre></div>
<pre><code>##    row col  value header.data header.header           header.data.data
## 1    1   1   7000      Female         0 - 6          Bachelor's degree
## 2    2   1  12000      Female         0 - 6          Bachelor's degree
## 3    3   1  10000      Female         0 - 6          Bachelor's degree
## 4    5   1  29000      Female         0 - 6                Certificate
## 5    6   1  34000      Female         0 - 6                Certificate
## 6    7   1  30000      Female         0 - 6                Certificate
## 7    8   1  12000      Female         0 - 6                Certificate
## 8   10   1  10000      Female         0 - 6                    Diploma
## 9   11   1   6000      Female         0 - 6                    Diploma
## 10  12   1   5000      Female         0 - 6                    Diploma
## 11  13   1  10000      Female         0 - 6           No Qualification
## 12  14   1  11000      Female         0 - 6           No Qualification
## 13  15   1  19000      Female         0 - 6           No Qualification
## 14  16   1  16000      Female         0 - 6           No Qualification
## 15  18   1   5000      Female         0 - 6 Postgraduate qualification
## 16  19   1   6000      Female         0 - 6 Postgraduate qualification
## 17   1   2  27000      Female        7 - 10          Bachelor's degree
## 18   2   2 137000      Female        7 - 10          Bachelor's degree
## 19   3   2  64000      Female        7 - 10          Bachelor's degree
## 20   4   2  18000      Female        7 - 10          Bachelor's degree
## 21   5   2 161000      Female        7 - 10                Certificate
## 22   6   2 179000      Female        7 - 10                Certificate
## 23   7   2 210000      Female        7 - 10                Certificate
## 24   8   2  77000      Female        7 - 10                Certificate
## 25   9   2  14000      Female        7 - 10                    Diploma
## 26  10   2  66000      Female        7 - 10                    Diploma
## 27  11   2  68000      Female        7 - 10                    Diploma
## 28  12   2  41000      Female        7 - 10                    Diploma
## 29  13   2  43000      Female        7 - 10           No Qualification
## 30  14   2  36000      Female        7 - 10           No Qualification
## 31  15   2  91000      Female        7 - 10           No Qualification
## 32  16   2 118000      Female        7 - 10           No Qualification
## 33  17   2   6000      Female        7 - 10 Postgraduate qualification
## 34  18   2  86000      Female        7 - 10 Postgraduate qualification
## 35  19   2  55000      Female        7 - 10 Postgraduate qualification
## 36  20   2  13000      Female        7 - 10 Postgraduate qualification
## 37   2   3   9000        Male         0 - 6          Bachelor's degree
## 38   3   3   7000        Male         0 - 6          Bachelor's degree
## 39   4   3   7000        Male         0 - 6          Bachelor's degree
## 40   5   3  30000        Male         0 - 6                Certificate
## 41   6   3  31000        Male         0 - 6                Certificate
## 42   7   3  23000        Male         0 - 6                Certificate
## 43   8   3   8000        Male         0 - 6                Certificate
## 44   9   3   9000        Male         0 - 6                    Diploma
## 45  10   3   8000        Male         0 - 6                    Diploma
## 46  11   3   5000        Male         0 - 6                    Diploma
## 47  12   3   1000        Male         0 - 6                    Diploma
## 48  13   3  12000        Male         0 - 6           No Qualification
## 49  14   3  21000        Male         0 - 6           No Qualification
## 50  15   3  17000        Male         0 - 6           No Qualification
## 51  16   3   9000        Male         0 - 6           No Qualification
## 52  18   3   7000        Male         0 - 6 Postgraduate qualification
## 53  19   3   6000        Male         0 - 6 Postgraduate qualification
## 54   1   4  13000        Male        7 - 10          Bachelor's degree
## 55   2   4  81000        Male        7 - 10          Bachelor's degree
## 56   3   4  66000        Male        7 - 10          Bachelor's degree
## 57   4   4  17000        Male        7 - 10          Bachelor's degree
## 58   5   4 190000        Male        7 - 10                Certificate
## 59   6   4 219000        Male        7 - 10                Certificate
## 60   7   4 199000        Male        7 - 10                Certificate
## 61   8   4 107000        Male        7 - 10                Certificate
## 62   9   4  11000        Male        7 - 10                    Diploma
## 63  10   4  47000        Male        7 - 10                    Diploma
## 64  11   4  58000        Male        7 - 10                    Diploma
## 65  12   4  34000        Male        7 - 10                    Diploma
## 66  13   4  37000        Male        7 - 10           No Qualification
## 67  14   4  50000        Male        7 - 10           No Qualification
## 68  15   4  75000        Male        7 - 10           No Qualification
## 69  16   4  66000        Male        7 - 10           No Qualification
## 70  18   4  60000        Male        7 - 10 Postgraduate qualification
## 71  19   4  68000        Male        7 - 10 Postgraduate qualification
## 72  20   4  18000        Male        7 - 10 Postgraduate qualification
##    header.header.header
## 1               15 - 24
## 2               25 - 44
## 3               45 - 64
## 4               15 - 24
## 5               25 - 44
## 6               45 - 64
## 7                   65+
## 8               25 - 44
## 9               45 - 64
## 10                  65+
## 11              15 - 24
## 12              25 - 44
## 13              45 - 64
## 14                  65+
## 15              25 - 44
## 16              45 - 64
## 17              15 - 24
## 18              25 - 44
## 19              45 - 64
## 20                  65+
## 21              15 - 24
## 22              25 - 44
## 23              45 - 64
## 24                  65+
## 25              15 - 24
## 26              25 - 44
## 27              45 - 64
## 28                  65+
## 29              15 - 24
## 30              25 - 44
## 31              45 - 64
## 32                  65+
## 33              15 - 24
## 34              25 - 44
## 35              45 - 64
## 36                  65+
## 37              25 - 44
## 38              45 - 64
## 39                  65+
## 40              15 - 24
## 41              25 - 44
## 42              45 - 64
## 43                  65+
## 44              15 - 24
## 45              25 - 44
## 46              45 - 64
## 47                  65+
## 48              15 - 24
## 49              25 - 44
## 50              45 - 64
## 51                  65+
## 52              25 - 44
## 53              45 - 64
## 54              15 - 24
## 55              25 - 44
## 56              45 - 64
## 57                  65+
## 58              15 - 24
## 59              25 - 44
## 60              45 - 64
## 61                  65+
## 62              15 - 24
## 63              25 - 44
## 64              45 - 64
## 65                  65+
## 66              15 - 24
## 67              25 - 44
## 68              45 - 64
## 69                  65+
## 70              25 - 44
## 71              45 - 64
## 72                  65+</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">SSW_ENE &lt;-<span class="st"> </span>datacells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(row, col)</code></pre></div>
</div>
</div>
<div id="check-that-all-sheets-are-parsed-correctly" class="section level2">
<h2>Check that all sheets are parsed correctly</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identical</span>(NNW_WNW, NNE_WSW)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identical</span>(SSW_ENE, SSE_ESE)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identical</span>(NNW_WNW[, <span class="op">-</span><span class="dv">1</span><span class="op">:-</span><span class="dv">2</span>], SSW_ENE[, <span class="op">-</span><span class="dv">1</span><span class="op">:-</span><span class="dv">2</span>])</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="above-left-example" class="section level2">
<h2>ABOVE LEFT example</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cells &lt;-<span class="st"> </span><span class="kw">tidytable</span>(purpose<span class="op">$</span><span class="st">`</span><span class="dt">ABOVE LEFT</span><span class="st">`</span>, <span class="dt">colnames =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div id="headers-2" class="section level3">
<h3>Headers</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">row_headers &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="op">!</span><span class="kw">is.na</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)
row_headers</code></pre></div>
<pre><code>## $`1`
##   row col header
## 1   5   1 Female
## 2  10   1   Male
## 
## $`2`
##    row col                     header
## 3    3   2          Bachelor's degree
## 4    4   2                Certificate
## 5    5   2                    Diploma
## 6    6   2           No Qualification
## 7    7   2 Postgraduate qualification
## 8    8   2          Bachelor's degree
## 9    9   2                Certificate
## 10  10   2                    Diploma
## 11  11   2           No Qualification
## 12  12   2 Postgraduate qualification</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">col_headers &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="op">!</span><span class="kw">is.na</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)
col_headers</code></pre></div>
<pre><code>## $`1`
##   row col header
## 2   1   4  0 - 6
## 6   1   7 7 - 10
## 
## $`2`
##   row col  header
## 1   2   3 15 - 24
## 3   2   4 25 - 44
## 4   2   5 45 - 64
## 5   2   6 15 - 24
## 7   2   7 25 - 44
## 8   2   8 45 - 64</code></pre>
</div>
<div id="data-2" class="section level3">
<h3>Data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, <span class="op">!</span><span class="kw">is.na</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, value)
datacells</code></pre></div>
<pre><code>##    row col  value
## 1    3   3   7000
## 2    4   3  29000
## 3    6   3  10000
## 4    9   3  30000
## 5   10   3   9000
## 6   11   3  12000
## 7    3   4  12000
## 8    4   4  34000
## 9    5   4  10000
## 10   6   4  11000
## 11   7   4   5000
## 12   8   4   9000
## 13   9   4  31000
## 14  10   4   8000
## 15  11   4  21000
## 16  12   4   7000
## 17   3   5  10000
## 18   4   5  30000
## 19   5   5   6000
## 20   6   5  19000
## 21   7   5   6000
## 22   8   5   7000
## 23   9   5  23000
## 24  10   5   5000
## 25  11   5  17000
## 26  12   5   6000
## 27   3   6  27000
## 28   4   6 161000
## 29   5   6  14000
## 30   6   6  43000
## 31   7   6   6000
## 32   8   6  13000
## 33   9   6 190000
## 34  10   6  11000
## 35  11   6  37000
## 36   3   7 137000
## 37   4   7 179000
## 38   5   7  66000
## 39   6   7  36000
## 40   7   7  86000
## 41   8   7  81000
## 42   9   7 219000
## 43  10   7  47000
## 44  11   7  50000
## 45  12   7  60000
## 46   3   8  64000
## 47   4   8 210000
## 48   5   8  68000
## 49   6   8  91000
## 50   7   8  55000
## 51   8   8  66000
## 52   9   8 199000
## 53  10   8  58000
## 54  11   8  75000
## 55  12   8  68000</code></pre>
</div>
<div id="join-headers-to-data-3" class="section level3">
<h3>Join headers to data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells &lt;-
<span class="st">  </span>datacells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ABOVE</span>(col_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from SSE ESE</span>
<span class="st">  </span><span class="kw">N</span>(col_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Same as SSE ESE</span>
<span class="st">  </span><span class="kw">LEFT</span>(row_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from SSE ESE</span>
<span class="st">  </span><span class="kw">W</span>(row_headers[[<span class="dv">2</span>]]) <span class="co"># Same as SSE ESE</span></code></pre></div>
</div>
<div id="result-4" class="section level3">
<h3>Result</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</code></pre></div>
<pre><code>##    row col  value header.data header.header header.data.data
## 1    3   3   7000       0 - 6       15 - 24           Female
## 2    4   3  29000       0 - 6       15 - 24           Female
## 3    6   3  10000       0 - 6       15 - 24           Female
## 4    9   3  30000       0 - 6       15 - 24             Male
## 5   10   3   9000       0 - 6       15 - 24             Male
## 6   11   3  12000       0 - 6       15 - 24             Male
## 7    3   4  12000       0 - 6       25 - 44           Female
## 8    4   4  34000       0 - 6       25 - 44           Female
## 9    5   4  10000       0 - 6       25 - 44           Female
## 10   6   4  11000       0 - 6       25 - 44           Female
## 11   7   4   5000       0 - 6       25 - 44           Female
## 12   8   4   9000       0 - 6       25 - 44             Male
## 13   9   4  31000       0 - 6       25 - 44             Male
## 14  10   4   8000       0 - 6       25 - 44             Male
## 15  11   4  21000       0 - 6       25 - 44             Male
## 16  12   4   7000       0 - 6       25 - 44             Male
## 17   3   5  10000       0 - 6       45 - 64           Female
## 18   4   5  30000       0 - 6       45 - 64           Female
## 19   5   5   6000       0 - 6       45 - 64           Female
## 20   6   5  19000       0 - 6       45 - 64           Female
## 21   7   5   6000       0 - 6       45 - 64           Female
## 22   8   5   7000       0 - 6       45 - 64             Male
## 23   9   5  23000       0 - 6       45 - 64             Male
## 24  10   5   5000       0 - 6       45 - 64             Male
## 25  11   5  17000       0 - 6       45 - 64             Male
## 26  12   5   6000       0 - 6       45 - 64             Male
## 27   3   6  27000      7 - 10       15 - 24           Female
## 28   4   6 161000      7 - 10       15 - 24           Female
## 29   5   6  14000      7 - 10       15 - 24           Female
## 30   6   6  43000      7 - 10       15 - 24           Female
## 31   7   6   6000      7 - 10       15 - 24           Female
## 32   8   6  13000      7 - 10       15 - 24             Male
## 33   9   6 190000      7 - 10       15 - 24             Male
## 34  10   6  11000      7 - 10       15 - 24             Male
## 35  11   6  37000      7 - 10       15 - 24             Male
## 36   3   7 137000      7 - 10       25 - 44           Female
## 37   4   7 179000      7 - 10       25 - 44           Female
## 38   5   7  66000      7 - 10       25 - 44           Female
## 39   6   7  36000      7 - 10       25 - 44           Female
## 40   7   7  86000      7 - 10       25 - 44           Female
## 41   8   7  81000      7 - 10       25 - 44             Male
## 42   9   7 219000      7 - 10       25 - 44             Male
## 43  10   7  47000      7 - 10       25 - 44             Male
## 44  11   7  50000      7 - 10       25 - 44             Male
## 45  12   7  60000      7 - 10       25 - 44             Male
## 46   3   8  64000      7 - 10       45 - 64           Female
## 47   4   8 210000      7 - 10       45 - 64           Female
## 48   5   8  68000      7 - 10       45 - 64           Female
## 49   6   8  91000      7 - 10       45 - 64           Female
## 50   7   8  55000      7 - 10       45 - 64           Female
## 51   8   8  66000      7 - 10       45 - 64             Male
## 52   9   8 199000      7 - 10       45 - 64             Male
## 53  10   8  58000      7 - 10       45 - 64             Male
## 54  11   8  75000      7 - 10       45 - 64             Male
## 55  12   8  68000      7 - 10       45 - 64             Male
##          header.header.header
## 1           Bachelor's degree
## 2                 Certificate
## 3            No Qualification
## 4                 Certificate
## 5                     Diploma
## 6            No Qualification
## 7           Bachelor's degree
## 8                 Certificate
## 9                     Diploma
## 10           No Qualification
## 11 Postgraduate qualification
## 12          Bachelor's degree
## 13                Certificate
## 14                    Diploma
## 15           No Qualification
## 16 Postgraduate qualification
## 17          Bachelor's degree
## 18                Certificate
## 19                    Diploma
## 20           No Qualification
## 21 Postgraduate qualification
## 22          Bachelor's degree
## 23                Certificate
## 24                    Diploma
## 25           No Qualification
## 26 Postgraduate qualification
## 27          Bachelor's degree
## 28                Certificate
## 29                    Diploma
## 30           No Qualification
## 31 Postgraduate qualification
## 32          Bachelor's degree
## 33                Certificate
## 34                    Diploma
## 35           No Qualification
## 36          Bachelor's degree
## 37                Certificate
## 38                    Diploma
## 39           No Qualification
## 40 Postgraduate qualification
## 41          Bachelor's degree
## 42                Certificate
## 43                    Diploma
## 44           No Qualification
## 45 Postgraduate qualification
## 46          Bachelor's degree
## 47                Certificate
## 48                    Diploma
## 49           No Qualification
## 50 Postgraduate qualification
## 51          Bachelor's degree
## 52                Certificate
## 53                    Diploma
## 54           No Qualification
## 55 Postgraduate qualification</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ABOVE_LEFT &lt;-<span class="st"> </span>datacells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(row, col)</code></pre></div>
</div>
</div>
<div id="below-right-example" class="section level2">
<h2>BELOW RIGHT example</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cells &lt;-<span class="st"> </span><span class="kw">tidytable</span>(purpose<span class="op">$</span><span class="st">`</span><span class="dt">BELOW RIGHT</span><span class="st">`</span>, <span class="dt">colnames =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div id="headers-3" class="section level3">
<h3>Headers</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">row_headers &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">7</span>, <span class="op">!</span><span class="kw">is.na</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)
row_headers</code></pre></div>
<pre><code>## $`7`
##    row col                     header
## 1    1   7          Bachelor's degree
## 2    2   7                Certificate
## 3    3   7                    Diploma
## 4    4   7           No Qualification
## 5    5   7 Postgraduate qualification
## 6    6   7          Bachelor's degree
## 7    7   7                Certificate
## 8    8   7                    Diploma
## 9    9   7           No Qualification
## 10  10   7 Postgraduate qualification
## 
## $`8`
##    row col header
## 11   3   8 Female
## 12   8   8   Male</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">col_headers &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">11</span>, <span class="op">!</span><span class="kw">is.na</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)
col_headers</code></pre></div>
<pre><code>## $`11`
##   row col  header
## 1  11   1 15 - 24
## 2  11   2 25 - 44
## 4  11   3 45 - 64
## 5  11   4 15 - 24
## 6  11   5 25 - 44
## 8  11   6 45 - 64
## 
## $`12`
##   row col header
## 3  12   2  0 - 6
## 7  12   5 7 - 10</code></pre>
</div>
<div id="data-3" class="section level3">
<h3>Data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>, col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">6</span>, <span class="op">!</span><span class="kw">is.na</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, value)
datacells</code></pre></div>
<pre><code>##    row col  value
## 1    1   1   7000
## 2    2   1  29000
## 3    4   1  10000
## 4    7   1  30000
## 5    8   1   9000
## 6    9   1  12000
## 7    1   2  12000
## 8    2   2  34000
## 9    3   2  10000
## 10   4   2  11000
## 11   5   2   5000
## 12   6   2   9000
## 13   7   2  31000
## 14   8   2   8000
## 15   9   2  21000
## 16  10   2   7000
## 17   1   3  10000
## 18   2   3  30000
## 19   3   3   6000
## 20   4   3  19000
## 21   5   3   6000
## 22   6   3   7000
## 23   7   3  23000
## 24   8   3   5000
## 25   9   3  17000
## 26  10   3   6000
## 27   1   4  27000
## 28   2   4 161000
## 29   3   4  14000
## 30   4   4  43000
## 31   5   4   6000
## 32   6   4  13000
## 33   7   4 190000
## 34   8   4  11000
## 35   9   4  37000
## 36   1   5 137000
## 37   2   5 179000
## 38   3   5  66000
## 39   4   5  36000
## 40   5   5  86000
## 41   6   5  81000
## 42   7   5 219000
## 43   8   5  47000
## 44   9   5  50000
## 45  10   5  60000
## 46   1   6  64000
## 47   2   6 210000
## 48   3   6  68000
## 49   4   6  91000
## 50   5   6  55000
## 51   6   6  66000
## 52   7   6 199000
## 53   8   6  58000
## 54   9   6  75000
## 55  10   6  68000</code></pre>
</div>
<div id="join-headers-to-data-4" class="section level3">
<h3>Join headers to data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells &lt;-
<span class="st">  </span>datacells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">BELOW</span>(col_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">S</span>(col_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">RIGHT</span>(row_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">E</span>(row_headers[[<span class="dv">1</span>]])</code></pre></div>
</div>
<div id="result-5" class="section level3">
<h3>Result</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</code></pre></div>
<pre><code>##    row col  value header.data header.header header.data.data
## 1    1   1   7000       0 - 6       15 - 24           Female
## 2    2   1  29000       0 - 6       15 - 24           Female
## 3    4   1  10000       0 - 6       15 - 24           Female
## 4    7   1  30000       0 - 6       15 - 24             Male
## 5    8   1   9000       0 - 6       15 - 24             Male
## 6    9   1  12000       0 - 6       15 - 24             Male
## 7    1   2  12000       0 - 6       25 - 44           Female
## 8    2   2  34000       0 - 6       25 - 44           Female
## 9    3   2  10000       0 - 6       25 - 44           Female
## 10   4   2  11000       0 - 6       25 - 44           Female
## 11   5   2   5000       0 - 6       25 - 44           Female
## 12   6   2   9000       0 - 6       25 - 44             Male
## 13   7   2  31000       0 - 6       25 - 44             Male
## 14   8   2   8000       0 - 6       25 - 44             Male
## 15   9   2  21000       0 - 6       25 - 44             Male
## 16  10   2   7000       0 - 6       25 - 44             Male
## 17   1   3  10000       0 - 6       45 - 64           Female
## 18   2   3  30000       0 - 6       45 - 64           Female
## 19   3   3   6000       0 - 6       45 - 64           Female
## 20   4   3  19000       0 - 6       45 - 64           Female
## 21   5   3   6000       0 - 6       45 - 64           Female
## 22   6   3   7000       0 - 6       45 - 64             Male
## 23   7   3  23000       0 - 6       45 - 64             Male
## 24   8   3   5000       0 - 6       45 - 64             Male
## 25   9   3  17000       0 - 6       45 - 64             Male
## 26  10   3   6000       0 - 6       45 - 64             Male
## 27   1   4  27000      7 - 10       15 - 24           Female
## 28   2   4 161000      7 - 10       15 - 24           Female
## 29   3   4  14000      7 - 10       15 - 24           Female
## 30   4   4  43000      7 - 10       15 - 24           Female
## 31   5   4   6000      7 - 10       15 - 24           Female
## 32   6   4  13000      7 - 10       15 - 24             Male
## 33   7   4 190000      7 - 10       15 - 24             Male
## 34   8   4  11000      7 - 10       15 - 24             Male
## 35   9   4  37000      7 - 10       15 - 24             Male
## 36   1   5 137000      7 - 10       25 - 44           Female
## 37   2   5 179000      7 - 10       25 - 44           Female
## 38   3   5  66000      7 - 10       25 - 44           Female
## 39   4   5  36000      7 - 10       25 - 44           Female
## 40   5   5  86000      7 - 10       25 - 44           Female
## 41   6   5  81000      7 - 10       25 - 44             Male
## 42   7   5 219000      7 - 10       25 - 44             Male
## 43   8   5  47000      7 - 10       25 - 44             Male
## 44   9   5  50000      7 - 10       25 - 44             Male
## 45  10   5  60000      7 - 10       25 - 44             Male
## 46   1   6  64000      7 - 10       45 - 64           Female
## 47   2   6 210000      7 - 10       45 - 64           Female
## 48   3   6  68000      7 - 10       45 - 64           Female
## 49   4   6  91000      7 - 10       45 - 64           Female
## 50   5   6  55000      7 - 10       45 - 64           Female
## 51   6   6  66000      7 - 10       45 - 64             Male
## 52   7   6 199000      7 - 10       45 - 64             Male
## 53   8   6  58000      7 - 10       45 - 64             Male
## 54   9   6  75000      7 - 10       45 - 64             Male
## 55  10   6  68000      7 - 10       45 - 64             Male
##          header.header.header
## 1           Bachelor's degree
## 2                 Certificate
## 3            No Qualification
## 4                 Certificate
## 5                     Diploma
## 6            No Qualification
## 7           Bachelor's degree
## 8                 Certificate
## 9                     Diploma
## 10           No Qualification
## 11 Postgraduate qualification
## 12          Bachelor's degree
## 13                Certificate
## 14                    Diploma
## 15           No Qualification
## 16 Postgraduate qualification
## 17          Bachelor's degree
## 18                Certificate
## 19                    Diploma
## 20           No Qualification
## 21 Postgraduate qualification
## 22          Bachelor's degree
## 23                Certificate
## 24                    Diploma
## 25           No Qualification
## 26 Postgraduate qualification
## 27          Bachelor's degree
## 28                Certificate
## 29                    Diploma
## 30           No Qualification
## 31 Postgraduate qualification
## 32          Bachelor's degree
## 33                Certificate
## 34                    Diploma
## 35           No Qualification
## 36          Bachelor's degree
## 37                Certificate
## 38                    Diploma
## 39           No Qualification
## 40 Postgraduate qualification
## 41          Bachelor's degree
## 42                Certificate
## 43                    Diploma
## 44           No Qualification
## 45 Postgraduate qualification
## 46          Bachelor's degree
## 47                Certificate
## 48                    Diploma
## 49           No Qualification
## 50 Postgraduate qualification
## 51          Bachelor's degree
## 52                Certificate
## 53                    Diploma
## 54           No Qualification
## 55 Postgraduate qualification</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">BELOW_RIGHT &lt;-<span class="st"> </span>datacells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(row, col)</code></pre></div>
</div>
</div>
<div id="check-that-all-sheets-are-parsed-correctly-1" class="section level2">
<h2>Check that all sheets are parsed correctly</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identical</span>(ABOVE_LEFT[, <span class="op">-</span><span class="dv">1</span><span class="op">:-</span><span class="dv">2</span>], BELOW_RIGHT[, <span class="op">-</span><span class="dv">1</span><span class="op">:-</span><span class="dv">2</span>])</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="above-left-border-example" class="section level2">
<h2>ABOVE LEFT border example</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">spreadsheet &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/purpose.xlsx&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;unpivotr&quot;</span>)
cells &lt;-<span class="st"> </span><span class="kw">tidy_xlsx</span>(spreadsheet, <span class="st">&quot;ABOVE LEFT border&quot;</span>)<span class="op">$</span>data[[<span class="dv">1</span>]]</code></pre></div>
<div id="headers-4" class="section level3">
<h3>Headers</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Same as ABOVE LEFT without borders</span>
row_headers &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>, <span class="op">!</span><span class="kw">is.na</span>(content)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)
row_headers</code></pre></div>
<pre><code>## $`2`
## # A tibble: 2 × 3
##     row   col header
##   &lt;int&gt; &lt;int&gt;  &lt;chr&gt;
## 1     5     2 Female
## 2    10     2   Male
## 
## $`3`
## # A tibble: 10 × 3
##      row   col                     header
##    &lt;int&gt; &lt;int&gt;                      &lt;chr&gt;
## 1      4     3          Bachelor's degree
## 2      5     3                Certificate
## 3      6     3                    Diploma
## 4      7     3           No Qualification
## 5      8     3 Postgraduate qualification
## 6      9     3          Bachelor's degree
## 7     10     3                Certificate
## 8     11     3                    Diploma
## 9     12     3           No Qualification
## 10    13     3 Postgraduate qualification</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">col_headers &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>, <span class="op">!</span><span class="kw">is.na</span>(content)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)
col_headers</code></pre></div>
<pre><code>## $`2`
## # A tibble: 2 × 3
##     row   col header
##   &lt;int&gt; &lt;int&gt;  &lt;chr&gt;
## 1     2     6  0 - 6
## 2     2     8 7 - 10
## 
## $`3`
## # A tibble: 6 × 3
##     row   col  header
##   &lt;int&gt; &lt;int&gt;   &lt;chr&gt;
## 1     3     4 15 - 24
## 2     3     5 25 - 44
## 3     3     6 45 - 64
## 4     3     7 15 - 24
## 5     3     8 25 - 44
## 6     3     9 45 - 64</code></pre>
</div>
<div id="data-4" class="section level3">
<h3>Data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Same as ABOVE LEFT without borders</span>
datacells &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">4</span>, col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">4</span>, <span class="op">!</span><span class="kw">is.na</span>(content)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">content =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(character), content, <span class="ot">NA</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, value)
datacells</code></pre></div>
<pre><code>## # A tibble: 55 × 3
##      row   col value
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1      4     4    NA
## 2      4     5    NA
## 3      4     6    NA
## 4      4     7    NA
## 5      4     8    NA
## 6      4     9    NA
## 7      5     4    NA
## 8      5     5    NA
## 9      5     6    NA
## 10     5     7    NA
## # ... with 45 more rows</code></pre>
</div>
<div id="borders" class="section level3">
<h3>Borders</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Different from ABOVE LEFT without borders</span>
<span class="co"># Find cells with borders on the bottom, and ones with borders on the left</span>
formatting &lt;-<span class="st"> </span><span class="kw">tidy_xlsx</span>(spreadsheet)<span class="op">$</span>formats
left_borders &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(formatting<span class="op">$</span>local<span class="op">$</span>border<span class="op">$</span>left<span class="op">$</span>style))
top_borders &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(formatting<span class="op">$</span>local<span class="op">$</span>border<span class="op">$</span>top<span class="op">$</span>style))

left_border_cells &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(row <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, local_format_id <span class="op">%in%</span><span class="st"> </span>left_borders) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col)
top_border_cells &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(col <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, local_format_id <span class="op">%in%</span><span class="st"> </span>top_borders) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col)</code></pre></div>
</div>
<div id="join-headers-to-data-5" class="section level3">
<h3>Join headers to data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells &lt;-
<span class="st">  </span>datacells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ABOVE</span>(col_headers[[<span class="dv">1</span>]], left_border_cells) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from ABOVE LEFT</span>
<span class="st">  </span><span class="kw">N</span>(col_headers[[<span class="dv">2</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Same as ABOVE LEFT</span>
<span class="st">  </span><span class="kw">LEFT</span>(row_headers[[<span class="dv">1</span>]], top_border_cells) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from ABOVE LEFT</span>
<span class="st">  </span><span class="kw">W</span>(row_headers[[<span class="dv">2</span>]]) <span class="co"># Same as ABOVE LEFT</span></code></pre></div>
</div>
<div id="result-6" class="section level3">
<h3>Result</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</code></pre></div>
<pre><code>##    row col value header.data header.header header.data.data
## 1    4   4    NA       0 - 6       15 - 24           Female
## 2    4   5    NA       0 - 6       25 - 44           Female
## 3    4   6    NA       0 - 6       45 - 64           Female
## 4    4   7    NA      7 - 10       15 - 24           Female
## 5    4   8    NA      7 - 10       25 - 44           Female
## 6    4   9    NA      7 - 10       45 - 64           Female
## 7    5   4    NA       0 - 6       15 - 24           Female
## 8    5   5    NA       0 - 6       25 - 44           Female
## 9    5   6    NA       0 - 6       45 - 64           Female
## 10   5   7    NA      7 - 10       15 - 24           Female
## 11   5   8    NA      7 - 10       25 - 44           Female
## 12   5   9    NA      7 - 10       45 - 64           Female
## 13   6   5    NA       0 - 6       25 - 44           Female
## 14   6   6    NA       0 - 6       45 - 64           Female
## 15   6   7    NA      7 - 10       15 - 24           Female
## 16   6   8    NA      7 - 10       25 - 44           Female
## 17   6   9    NA      7 - 10       45 - 64           Female
## 18   7   4    NA       0 - 6       15 - 24           Female
## 19   7   5    NA       0 - 6       25 - 44           Female
## 20   7   6    NA       0 - 6       45 - 64           Female
## 21   7   7    NA      7 - 10       15 - 24           Female
## 22   7   8    NA      7 - 10       25 - 44           Female
## 23   7   9    NA      7 - 10       45 - 64           Female
## 24   8   5    NA       0 - 6       25 - 44           Female
## 25   8   6    NA       0 - 6       45 - 64           Female
## 26   8   7    NA      7 - 10       15 - 24           Female
## 27   8   8    NA      7 - 10       25 - 44           Female
## 28   8   9    NA      7 - 10       45 - 64           Female
## 29   9   5    NA       0 - 6       25 - 44             Male
## 30   9   6    NA       0 - 6       45 - 64             Male
## 31   9   7    NA      7 - 10       15 - 24             Male
## 32   9   8    NA      7 - 10       25 - 44             Male
## 33   9   9    NA      7 - 10       45 - 64             Male
## 34  10   4    NA       0 - 6       15 - 24             Male
## 35  10   5    NA       0 - 6       25 - 44             Male
## 36  10   6    NA       0 - 6       45 - 64             Male
## 37  10   7    NA      7 - 10       15 - 24             Male
## 38  10   8    NA      7 - 10       25 - 44             Male
## 39  10   9    NA      7 - 10       45 - 64             Male
## 40  11   4    NA       0 - 6       15 - 24             Male
## 41  11   5    NA       0 - 6       25 - 44             Male
## 42  11   6    NA       0 - 6       45 - 64             Male
## 43  11   7    NA      7 - 10       15 - 24             Male
## 44  11   8    NA      7 - 10       25 - 44             Male
## 45  11   9    NA      7 - 10       45 - 64             Male
## 46  12   4    NA       0 - 6       15 - 24             Male
## 47  12   5    NA       0 - 6       25 - 44             Male
## 48  12   6    NA       0 - 6       45 - 64             Male
## 49  12   7    NA      7 - 10       15 - 24             Male
## 50  12   8    NA      7 - 10       25 - 44             Male
## 51  12   9    NA      7 - 10       45 - 64             Male
## 52  13   5    NA       0 - 6       25 - 44             Male
## 53  13   6    NA       0 - 6       45 - 64             Male
## 54  13   8    NA      7 - 10       25 - 44             Male
## 55  13   9    NA      7 - 10       45 - 64             Male
##          header.header.header
## 1           Bachelor's degree
## 2           Bachelor's degree
## 3           Bachelor's degree
## 4           Bachelor's degree
## 5           Bachelor's degree
## 6           Bachelor's degree
## 7                 Certificate
## 8                 Certificate
## 9                 Certificate
## 10                Certificate
## 11                Certificate
## 12                Certificate
## 13                    Diploma
## 14                    Diploma
## 15                    Diploma
## 16                    Diploma
## 17                    Diploma
## 18           No Qualification
## 19           No Qualification
## 20           No Qualification
## 21           No Qualification
## 22           No Qualification
## 23           No Qualification
## 24 Postgraduate qualification
## 25 Postgraduate qualification
## 26 Postgraduate qualification
## 27 Postgraduate qualification
## 28 Postgraduate qualification
## 29          Bachelor's degree
## 30          Bachelor's degree
## 31          Bachelor's degree
## 32          Bachelor's degree
## 33          Bachelor's degree
## 34                Certificate
## 35                Certificate
## 36                Certificate
## 37                Certificate
## 38                Certificate
## 39                Certificate
## 40                    Diploma
## 41                    Diploma
## 42                    Diploma
## 43                    Diploma
## 44                    Diploma
## 45                    Diploma
## 46           No Qualification
## 47           No Qualification
## 48           No Qualification
## 49           No Qualification
## 50           No Qualification
## 51           No Qualification
## 52 Postgraduate qualification
## 53 Postgraduate qualification
## 54 Postgraduate qualification
## 55 Postgraduate qualification</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ABOVE_LEFT_borders &lt;-<span class="st"> </span>datacells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(row, col)</code></pre></div>
</div>
</div>
<div id="below-right-border-example" class="section level2">
<h2>BELOW RIGHT border example</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cells &lt;-<span class="st"> </span><span class="kw">tidy_xlsx</span>(spreadsheet, <span class="st">&quot;BELOW RIGHT border&quot;</span>)<span class="op">$</span>data[[<span class="dv">1</span>]]</code></pre></div>
<div id="headers-5" class="section level3">
<h3>Headers</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Same as BELOW RIGHT without borders</span>
row_headers &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">10</span>, <span class="op">!</span><span class="kw">is.na</span>(content)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)
row_headers</code></pre></div>
<pre><code>## $`10`
## # A tibble: 10 × 3
##      row   col                     header
##    &lt;int&gt; &lt;int&gt;                      &lt;chr&gt;
## 1      4    10          Bachelor's degree
## 2      5    10                Certificate
## 3      6    10                    Diploma
## 4      7    10           No Qualification
## 5      8    10 Postgraduate qualification
## 6      9    10          Bachelor's degree
## 7     10    10                Certificate
## 8     11    10                    Diploma
## 9     12    10           No Qualification
## 10    13    10 Postgraduate qualification
## 
## $`11`
## # A tibble: 2 × 3
##     row   col header
##   &lt;int&gt; &lt;int&gt;  &lt;chr&gt;
## 1     7    11 Female
## 2    10    11   Male</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">col_headers &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">14</span>, <span class="op">!</span><span class="kw">is.na</span>(content)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)
col_headers</code></pre></div>
<pre><code>## $`14`
## # A tibble: 6 × 3
##     row   col  header
##   &lt;int&gt; &lt;int&gt;   &lt;chr&gt;
## 1    14     4 15 - 24
## 2    14     5 25 - 44
## 3    14     6 45 - 64
## 4    14     7 15 - 24
## 5    14     8 25 - 44
## 6    14     9 45 - 64
## 
## $`15`
## # A tibble: 2 × 3
##     row   col header
##   &lt;int&gt; &lt;int&gt;  &lt;chr&gt;
## 1    15     6  0 - 6
## 2    15     7 7 - 10</code></pre>
</div>
<div id="data-5" class="section level3">
<h3>Data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Same as BELOW RIGHT without borders</span>
datacells &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">13</span>, col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">9</span>, <span class="op">!</span><span class="kw">is.na</span>(content)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">content =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(character), content, <span class="ot">NA</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(character)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col, value)
datacells</code></pre></div>
<pre><code>## # A tibble: 55 × 3
##      row   col value
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1      4     4    NA
## 2      4     5    NA
## 3      4     6    NA
## 4      4     7    NA
## 5      4     8    NA
## 6      4     9    NA
## 7      5     4    NA
## 8      5     5    NA
## 9      5     6    NA
## 10     5     7    NA
## # ... with 45 more rows</code></pre>
</div>
<div id="borders-1" class="section level3">
<h3>Borders</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Different from BELOW RIGHT without borders</span>
<span class="co"># Find cells with borders on the bottom, and ones with borders on the left</span>
formatting &lt;-<span class="st"> </span><span class="kw">tidy_xlsx</span>(spreadsheet)<span class="op">$</span>formats
left_borders &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(formatting<span class="op">$</span>local<span class="op">$</span>border<span class="op">$</span>left<span class="op">$</span>style))
top_borders &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(formatting<span class="op">$</span>local<span class="op">$</span>border<span class="op">$</span>top<span class="op">$</span>style))

left_border_cells &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(row <span class="op">==</span><span class="st"> </span><span class="dv">15</span>, local_format_id <span class="op">%in%</span><span class="st"> </span>left_borders) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col)
top_border_cells &lt;-
<span class="st">  </span>cells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(col <span class="op">==</span><span class="st"> </span><span class="dv">11</span>, local_format_id <span class="op">%in%</span><span class="st"> </span>top_borders) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(row, col)</code></pre></div>
</div>
<div id="join-headers-to-data-6" class="section level3">
<h3>Join headers to data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells &lt;-
<span class="st">  </span>datacells <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">BELOW</span>(col_headers[[<span class="dv">2</span>]], left_border_cells) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from BELOW RIGHT</span>
<span class="st">  </span><span class="kw">S</span>(col_headers[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Same as BELOW RIGHT</span>
<span class="st">  </span><span class="kw">RIGHT</span>(row_headers[[<span class="dv">2</span>]], top_border_cells) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from BELOW RIGHT</span>
<span class="st">  </span><span class="kw">E</span>(row_headers[[<span class="dv">1</span>]]) <span class="co"># Same as BELOW RIGHT</span></code></pre></div>
</div>
<div id="result-7" class="section level3">
<h3>Result</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datacells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</code></pre></div>
<pre><code>##    row col value header.data header.header header.data.data
## 1    4   4    NA       0 - 6       15 - 24           Female
## 2    4   5    NA       0 - 6       25 - 44           Female
## 3    4   6    NA       0 - 6       45 - 64           Female
## 4    4   7    NA      7 - 10       15 - 24           Female
## 5    4   8    NA      7 - 10       25 - 44           Female
## 6    4   9    NA      7 - 10       45 - 64           Female
## 7    5   4    NA       0 - 6       15 - 24           Female
## 8    5   5    NA       0 - 6       25 - 44           Female
## 9    5   6    NA       0 - 6       45 - 64           Female
## 10   5   7    NA      7 - 10       15 - 24           Female
## 11   5   8    NA      7 - 10       25 - 44           Female
## 12   5   9    NA      7 - 10       45 - 64           Female
## 13   6   5    NA       0 - 6       25 - 44           Female
## 14   6   6    NA       0 - 6       45 - 64           Female
## 15   6   7    NA      7 - 10       15 - 24           Female
## 16   6   8    NA      7 - 10       25 - 44           Female
## 17   6   9    NA      7 - 10       45 - 64           Female
## 18   7   4    NA       0 - 6       15 - 24           Female
## 19   7   5    NA       0 - 6       25 - 44           Female
## 20   7   6    NA       0 - 6       45 - 64           Female
## 21   7   7    NA      7 - 10       15 - 24           Female
## 22   7   8    NA      7 - 10       25 - 44           Female
## 23   7   9    NA      7 - 10       45 - 64           Female
## 24   8   5    NA       0 - 6       25 - 44           Female
## 25   8   6    NA       0 - 6       45 - 64           Female
## 26   8   7    NA      7 - 10       15 - 24           Female
## 27   8   8    NA      7 - 10       25 - 44           Female
## 28   8   9    NA      7 - 10       45 - 64           Female
## 29   9   5    NA       0 - 6       25 - 44             Male
## 30   9   6    NA       0 - 6       45 - 64             Male
## 31   9   7    NA      7 - 10       15 - 24             Male
## 32   9   8    NA      7 - 10       25 - 44             Male
## 33   9   9    NA      7 - 10       45 - 64             Male
## 34  10   4    NA       0 - 6       15 - 24             Male
## 35  10   5    NA       0 - 6       25 - 44             Male
## 36  10   6    NA       0 - 6       45 - 64             Male
## 37  10   7    NA      7 - 10       15 - 24             Male
## 38  10   8    NA      7 - 10       25 - 44             Male
## 39  10   9    NA      7 - 10       45 - 64             Male
## 40  11   4    NA       0 - 6       15 - 24             Male
## 41  11   5    NA       0 - 6       25 - 44             Male
## 42  11   6    NA       0 - 6       45 - 64             Male
## 43  11   7    NA      7 - 10       15 - 24             Male
## 44  11   8    NA      7 - 10       25 - 44             Male
## 45  11   9    NA      7 - 10       45 - 64             Male
## 46  12   4    NA       0 - 6       15 - 24             Male
## 47  12   5    NA       0 - 6       25 - 44             Male
## 48  12   6    NA       0 - 6       45 - 64             Male
## 49  12   7    NA      7 - 10       15 - 24             Male
## 50  12   8    NA      7 - 10       25 - 44             Male
## 51  12   9    NA      7 - 10       45 - 64             Male
## 52  13   5    NA       0 - 6       25 - 44             Male
## 53  13   6    NA       0 - 6       45 - 64             Male
## 54  13   8    NA      7 - 10       25 - 44             Male
## 55  13   9    NA      7 - 10       45 - 64             Male
##          header.header.header
## 1           Bachelor's degree
## 2           Bachelor's degree
## 3           Bachelor's degree
## 4           Bachelor's degree
## 5           Bachelor's degree
## 6           Bachelor's degree
## 7                 Certificate
## 8                 Certificate
## 9                 Certificate
## 10                Certificate
## 11                Certificate
## 12                Certificate
## 13                    Diploma
## 14                    Diploma
## 15                    Diploma
## 16                    Diploma
## 17                    Diploma
## 18           No Qualification
## 19           No Qualification
## 20           No Qualification
## 21           No Qualification
## 22           No Qualification
## 23           No Qualification
## 24 Postgraduate qualification
## 25 Postgraduate qualification
## 26 Postgraduate qualification
## 27 Postgraduate qualification
## 28 Postgraduate qualification
## 29          Bachelor's degree
## 30          Bachelor's degree
## 31          Bachelor's degree
## 32          Bachelor's degree
## 33          Bachelor's degree
## 34                Certificate
## 35                Certificate
## 36                Certificate
## 37                Certificate
## 38                Certificate
## 39                Certificate
## 40                    Diploma
## 41                    Diploma
## 42                    Diploma
## 43                    Diploma
## 44                    Diploma
## 45                    Diploma
## 46           No Qualification
## 47           No Qualification
## 48           No Qualification
## 49           No Qualification
## 50           No Qualification
## 51           No Qualification
## 52 Postgraduate qualification
## 53 Postgraduate qualification
## 54 Postgraduate qualification
## 55 Postgraduate qualification</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">BELOW_RIGHT_borders &lt;-<span class="st"> </span>datacells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(row, col)</code></pre></div>
</div>
</div>
<div id="check-that-all-sheets-are-parsed-correctly-2" class="section level2">
<h2>Check that all sheets are parsed correctly</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identical</span>(ABOVE_LEFT[, <span class="op">-</span><span class="dv">1</span><span class="op">:-</span><span class="dv">2</span>], BELOW_RIGHT[, <span class="op">-</span><span class="dv">1</span><span class="op">:-</span><span class="dv">2</span>])</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identical</span>(ABOVE_LEFT[, <span class="op">-</span><span class="dv">1</span><span class="op">:-</span><span class="dv">2</span>], ABOVE_LEFT_borders[, <span class="op">-</span><span class="dv">1</span><span class="op">:-</span><span class="dv">2</span>])</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identical</span>(ABOVE_LEFT[, <span class="op">-</span><span class="dv">1</span><span class="op">:-</span><span class="dv">2</span>], BELOW_RIGHT_borders[, <span class="op">-</span><span class="dv">1</span><span class="op">:-</span><span class="dv">2</span>])</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
