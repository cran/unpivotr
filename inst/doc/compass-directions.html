<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Duncan Garmonsway" />

<meta name="date" content="2019-03-30" />

<title>Compass Directions</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Compass Directions</h1>
<h4 class="author">Duncan Garmonsway</h4>
<h4 class="date">2019-03-30</h4>


<div id="TOC">
<ul>
<li><a href="#nnw-wnw-example">NNW WNW example</a><ul>
<li><a href="#headers">Headers</a></li>
<li><a href="#data">Data</a></li>
<li><a href="#join-headers-to-data">Join headers to data</a></li>
<li><a href="#result">Result</a></li>
</ul></li>
<li><a href="#nne-wsw-example">NNE WSW example</a><ul>
<li><a href="#headers-same-as-nnw-wnw">Headers (same as NNW WNW)</a></li>
<li><a href="#data-same-as-nnw-wnw">Data (same as NNW WNW)</a></li>
<li><a href="#join-headers-to-data-different-from-nnw-wnw">Join headers to data (different from NNW WNW)</a></li>
<li><a href="#result-1">Result</a></li>
</ul></li>
<li><a href="#sse-ese-example">SSE ESE example</a><ul>
<li><a href="#headers-1">Headers</a></li>
<li><a href="#data-1">Data</a></li>
<li><a href="#join-headers-to-data-1">Join headers to data</a></li>
<li><a href="#result-2">Result</a></li>
</ul></li>
<li><a href="#ssw-ene-example">SSW ENE example</a><ul>
<li><a href="#headers-same-as-sse-ese">Headers (same as SSE ESE)</a></li>
<li><a href="#data-same-as-sse-ese">Data (same as SSE ESE)</a></li>
<li><a href="#join-headers-to-data-2">Join headers to data</a></li>
<li><a href="#result-3">Result</a></li>
</ul></li>
<li><a href="#check-that-all-sheets-are-parsed-correctly">Check that all sheets are parsed correctly</a></li>
<li><a href="#above-left-example">ABOVE LEFT example</a><ul>
<li><a href="#headers-2">Headers</a></li>
<li><a href="#data-2">Data</a></li>
<li><a href="#join-headers-to-data-3">Join headers to data</a></li>
<li><a href="#result-4">Result</a></li>
</ul></li>
<li><a href="#below-right-example">BELOW RIGHT example</a><ul>
<li><a href="#headers-3">Headers</a></li>
<li><a href="#data-3">Data</a></li>
<li><a href="#join-headers-to-data-4">Join headers to data</a></li>
<li><a href="#result-5">Result</a></li>
</ul></li>
<li><a href="#check-that-all-sheets-are-parsed-correctly-1">Check that all sheets are parsed correctly</a></li>
<li><a href="#above-left-border-example">ABOVE LEFT border example</a><ul>
<li><a href="#headers-4">Headers</a></li>
<li><a href="#data-4">Data</a></li>
<li><a href="#borders">Borders</a></li>
<li><a href="#join-headers-to-data-5">Join headers to data</a></li>
<li><a href="#result-6">Result</a></li>
</ul></li>
<li><a href="#below-right-border-example">BELOW RIGHT border example</a><ul>
<li><a href="#headers-5">Headers</a></li>
<li><a href="#data-5">Data</a></li>
<li><a href="#borders-1">Borders</a></li>
<li><a href="#join-headers-to-data-6">Join headers to data</a></li>
<li><a href="#result-7">Result</a></li>
</ul></li>
<li><a href="#check-that-all-sheets-are-parsed-correctly-2">Check that all sheets are parsed correctly</a></li>
</ul>
</div>

<p>This vignette for the <a href="https://github.com/nacnudus/unpivotr">unpivotr</a> package demonstrates unpivoting pivot tables of various kinds imported from a spreadsheet via the <a href="https://github.com/nacnudus/tidyxl">tidyxl</a> package. It is best read with the spreadsheet open in a spreadsheet program, e.g. Excel, LibreOffice Calc or Gnumeric.</p>
<p>The spreadsheet is in the package directory at <code>system.file(&quot;extdata&quot;, &quot;purpose.xlsx&quot;, package = &quot;unpivotr&quot;)</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(dplyr)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">library</span>(tidyxl)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">library</span>(unpivotr)</a></code></pre></div>
<div id="nnw-wnw-example" class="section level2">
<h2>NNW WNW example</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">(original &lt;-<span class="st"> </span>purpose<span class="op">$</span><span class="st">`</span><span class="dt">NNW WNW</span><span class="st">`</span>)</a></code></pre></div>
<pre><code>##                            X2      X3     X4     X5    X6     X7
## 1                        &lt;NA&gt;    &lt;NA&gt; Female   &lt;NA&gt;  Male   &lt;NA&gt;
## 2                        &lt;NA&gt;    &lt;NA&gt;  0 - 6 7 - 10 0 - 6 7 - 10
## 3           Bachelor&#39;s degree 15 - 24   7000  27000  &lt;NA&gt;  13000
## 4                        &lt;NA&gt; 25 - 44  12000 137000  9000  81000
## 5                        &lt;NA&gt; 45 - 64  10000  64000  7000  66000
## 6                        &lt;NA&gt;     65+   &lt;NA&gt;  18000  7000  17000
## 7                 Certificate 15 - 24  29000 161000 30000 190000
## 8                        &lt;NA&gt; 25 - 44  34000 179000 31000 219000
## 9                        &lt;NA&gt; 45 - 64  30000 210000 23000 199000
## 10                       &lt;NA&gt;     65+  12000  77000  8000 107000
## 11                    Diploma 15 - 24   &lt;NA&gt;  14000  9000  11000
## 12                       &lt;NA&gt; 25 - 44  10000  66000  8000  47000
## 13                       &lt;NA&gt; 45 - 64   6000  68000  5000  58000
## 14                       &lt;NA&gt;     65+   5000  41000  1000  34000
## 15           No Qualification 15 - 24  10000  43000 12000  37000
## 16                       &lt;NA&gt; 25 - 44  11000  36000 21000  50000
## 17                       &lt;NA&gt; 45 - 64  19000  91000 17000  75000
## 18                       &lt;NA&gt;     65+  16000 118000  9000  66000
## 19 Postgraduate qualification 15 - 24   &lt;NA&gt;   6000  &lt;NA&gt;   &lt;NA&gt;
## 20                       &lt;NA&gt; 25 - 44   5000  86000  7000  60000
## 21                       &lt;NA&gt; 45 - 64   6000  55000  6000  68000
## 22                       &lt;NA&gt;     65+   &lt;NA&gt;  13000  &lt;NA&gt;  18000</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">tail</span>(cells &lt;-<span class="st"> </span><span class="kw">as_cells</span>(original))</a></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##     row   col data_type chr  
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;
## 1    17     6 chr       75000
## 2    18     6 chr       66000
## 3    19     6 chr       &lt;NA&gt; 
## 4    20     6 chr       60000
## 5    21     6 chr       68000
## 6    22     6 chr       18000</code></pre>
<div id="headers" class="section level3">
<h3>Headers</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">row_headers &lt;-</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Select all rows of headers at once</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col) <span class="co"># Return each row of headers in its own element of a list</span></a>
<a class="sourceLine" id="cb10-6" title="6">row_headers</a></code></pre></div>
<pre><code>## $`1`
## # A tibble: 5 x 3
##     row   col header                    
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;                     
## 1     3     1 Bachelor&#39;s degree         
## 2     7     1 Certificate               
## 3    11     1 Diploma                   
## 4    15     1 No Qualification          
## 5    19     1 Postgraduate qualification
## 
## $`2`
## # A tibble: 20 x 3
##      row   col header 
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;  
##  1     3     2 15 - 24
##  2     4     2 25 - 44
##  3     5     2 45 - 64
##  4     6     2 65+    
##  5     7     2 15 - 24
##  6     8     2 25 - 44
##  7     9     2 45 - 64
##  8    10     2 65+    
##  9    11     2 15 - 24
## 10    12     2 25 - 44
## 11    13     2 45 - 64
## 12    14     2 65+    
## 13    15     2 15 - 24
## 14    16     2 25 - 44
## 15    17     2 45 - 64
## 16    18     2 65+    
## 17    19     2 15 - 24
## 18    20     2 25 - 44
## 19    21     2 45 - 64
## 20    22     2 65+</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">col_headers &lt;-</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)</a>
<a class="sourceLine" id="cb12-6" title="6">col_headers</a></code></pre></div>
<pre><code>## $`1`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     1     3 Female
## 2     1     5 Male  
## 
## $`2`
## # A tibble: 4 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     2     3 0 - 6 
## 2     2     4 7 - 10
## 3     2     5 0 - 6 
## 4     2     6 7 - 10</code></pre>
</div>
<div id="data" class="section level3">
<h3>Data</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">data_cells &lt;-</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="st">  </span><span class="kw">select</span>(row, col, value)</a>
<a class="sourceLine" id="cb14-6" title="6"><span class="kw">head</span>(data_cells)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##     row   col value
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1     3     3  7000
## 2     4     3 12000
## 3     5     3 10000
## 4     7     3 29000
## 5     8     3 34000
## 6     9     3 30000</code></pre>
</div>
<div id="join-headers-to-data" class="section level3">
<h3>Join headers to data</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">data_cells &lt;-</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="st">  </span>data_cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="st">  </span><span class="kw">enhead</span>(col_headers[[<span class="dv">1</span>]], <span class="st">&quot;NNW&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="st">  </span><span class="kw">enhead</span>(col_headers[[<span class="dv">2</span>]], <span class="st">&quot;N&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="st">  </span><span class="kw">enhead</span>(row_headers[[<span class="dv">1</span>]], <span class="st">&quot;WNW&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="st">  </span><span class="kw">enhead</span>(row_headers[[<span class="dv">2</span>]], <span class="st">&quot;W&quot;</span>)</a></code></pre></div>
</div>
<div id="result" class="section level3">
<h3>Result</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">data_cells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a></code></pre></div>
<pre><code>##    row col  value header.data header.header           header.data.data
## 1    3   3   7000      Female         0 - 6          Bachelor&#39;s degree
## 2    4   3  12000      Female         0 - 6          Bachelor&#39;s degree
## 3    5   3  10000      Female         0 - 6          Bachelor&#39;s degree
## 4    3   4  27000      Female        7 - 10          Bachelor&#39;s degree
## 5    4   4 137000      Female        7 - 10          Bachelor&#39;s degree
## 6    5   4  64000      Female        7 - 10          Bachelor&#39;s degree
## 7    6   4  18000      Female        7 - 10          Bachelor&#39;s degree
## 8    4   5   9000        Male         0 - 6          Bachelor&#39;s degree
## 9    5   5   7000        Male         0 - 6          Bachelor&#39;s degree
## 10   6   5   7000        Male         0 - 6          Bachelor&#39;s degree
## 11   3   6  13000        Male        7 - 10          Bachelor&#39;s degree
## 12   4   6  81000        Male        7 - 10          Bachelor&#39;s degree
## 13   5   6  66000        Male        7 - 10          Bachelor&#39;s degree
## 14   6   6  17000        Male        7 - 10          Bachelor&#39;s degree
## 15   7   3  29000      Female         0 - 6                Certificate
## 16   8   3  34000      Female         0 - 6                Certificate
## 17   9   3  30000      Female         0 - 6                Certificate
## 18  10   3  12000      Female         0 - 6                Certificate
## 19   7   4 161000      Female        7 - 10                Certificate
## 20   8   4 179000      Female        7 - 10                Certificate
## 21   9   4 210000      Female        7 - 10                Certificate
## 22  10   4  77000      Female        7 - 10                Certificate
## 23   7   5  30000        Male         0 - 6                Certificate
## 24   8   5  31000        Male         0 - 6                Certificate
## 25   9   5  23000        Male         0 - 6                Certificate
## 26  10   5   8000        Male         0 - 6                Certificate
## 27   7   6 190000        Male        7 - 10                Certificate
## 28   8   6 219000        Male        7 - 10                Certificate
## 29   9   6 199000        Male        7 - 10                Certificate
## 30  10   6 107000        Male        7 - 10                Certificate
## 31  12   3  10000      Female         0 - 6                    Diploma
## 32  13   3   6000      Female         0 - 6                    Diploma
## 33  14   3   5000      Female         0 - 6                    Diploma
## 34  11   4  14000      Female        7 - 10                    Diploma
## 35  12   4  66000      Female        7 - 10                    Diploma
## 36  13   4  68000      Female        7 - 10                    Diploma
## 37  14   4  41000      Female        7 - 10                    Diploma
## 38  11   5   9000        Male         0 - 6                    Diploma
## 39  12   5   8000        Male         0 - 6                    Diploma
## 40  13   5   5000        Male         0 - 6                    Diploma
## 41  14   5   1000        Male         0 - 6                    Diploma
## 42  11   6  11000        Male        7 - 10                    Diploma
## 43  12   6  47000        Male        7 - 10                    Diploma
## 44  13   6  58000        Male        7 - 10                    Diploma
## 45  14   6  34000        Male        7 - 10                    Diploma
## 46  15   3  10000      Female         0 - 6           No Qualification
## 47  16   3  11000      Female         0 - 6           No Qualification
## 48  17   3  19000      Female         0 - 6           No Qualification
## 49  18   3  16000      Female         0 - 6           No Qualification
## 50  15   4  43000      Female        7 - 10           No Qualification
## 51  16   4  36000      Female        7 - 10           No Qualification
## 52  17   4  91000      Female        7 - 10           No Qualification
## 53  18   4 118000      Female        7 - 10           No Qualification
## 54  15   5  12000        Male         0 - 6           No Qualification
## 55  16   5  21000        Male         0 - 6           No Qualification
## 56  17   5  17000        Male         0 - 6           No Qualification
## 57  18   5   9000        Male         0 - 6           No Qualification
## 58  15   6  37000        Male        7 - 10           No Qualification
## 59  16   6  50000        Male        7 - 10           No Qualification
## 60  17   6  75000        Male        7 - 10           No Qualification
## 61  18   6  66000        Male        7 - 10           No Qualification
## 62  20   3   5000      Female         0 - 6 Postgraduate qualification
## 63  21   3   6000      Female         0 - 6 Postgraduate qualification
## 64  19   4   6000      Female        7 - 10 Postgraduate qualification
## 65  20   4  86000      Female        7 - 10 Postgraduate qualification
## 66  21   4  55000      Female        7 - 10 Postgraduate qualification
## 67  22   4  13000      Female        7 - 10 Postgraduate qualification
## 68  20   5   7000        Male         0 - 6 Postgraduate qualification
## 69  21   5   6000        Male         0 - 6 Postgraduate qualification
## 70  20   6  60000        Male        7 - 10 Postgraduate qualification
## 71  21   6  68000        Male        7 - 10 Postgraduate qualification
## 72  22   6  18000        Male        7 - 10 Postgraduate qualification
##    header.header.header
## 1               15 - 24
## 2               25 - 44
## 3               45 - 64
## 4               15 - 24
## 5               25 - 44
## 6               45 - 64
## 7                   65+
## 8               25 - 44
## 9               45 - 64
## 10                  65+
## 11              15 - 24
## 12              25 - 44
## 13              45 - 64
## 14                  65+
## 15              15 - 24
## 16              25 - 44
## 17              45 - 64
## 18                  65+
## 19              15 - 24
## 20              25 - 44
## 21              45 - 64
## 22                  65+
## 23              15 - 24
## 24              25 - 44
## 25              45 - 64
## 26                  65+
## 27              15 - 24
## 28              25 - 44
## 29              45 - 64
## 30                  65+
## 31              25 - 44
## 32              45 - 64
## 33                  65+
## 34              15 - 24
## 35              25 - 44
## 36              45 - 64
## 37                  65+
## 38              15 - 24
## 39              25 - 44
## 40              45 - 64
## 41                  65+
## 42              15 - 24
## 43              25 - 44
## 44              45 - 64
## 45                  65+
## 46              15 - 24
## 47              25 - 44
## 48              45 - 64
## 49                  65+
## 50              15 - 24
## 51              25 - 44
## 52              45 - 64
## 53                  65+
## 54              15 - 24
## 55              25 - 44
## 56              45 - 64
## 57                  65+
## 58              15 - 24
## 59              25 - 44
## 60              45 - 64
## 61                  65+
## 62              25 - 44
## 63              45 - 64
## 64              15 - 24
## 65              25 - 44
## 66              45 - 64
## 67                  65+
## 68              25 - 44
## 69              45 - 64
## 70              25 - 44
## 71              45 - 64
## 72                  65+</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">NNW_WNW &lt;-<span class="st"> </span>data_cells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(row, col)</a></code></pre></div>
</div>
</div>
<div id="nne-wsw-example" class="section level2">
<h2>NNE WSW example</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">cells &lt;-<span class="st"> </span><span class="kw">as_cells</span>(purpose<span class="op">$</span><span class="st">`</span><span class="dt">NNE WSW</span><span class="st">`</span>)</a></code></pre></div>
<div id="headers-same-as-nnw-wnw" class="section level3">
<h3>Headers (same as NNW WNW)</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">row_headers &lt;-</a>
<a class="sourceLine" id="cb21-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-5" title="5"><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)</a>
<a class="sourceLine" id="cb21-6" title="6">row_headers</a></code></pre></div>
<pre><code>## $`1`
## # A tibble: 5 x 3
##     row   col header                    
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;                     
## 1     6     1 Bachelor&#39;s degree         
## 2    10     1 Certificate               
## 3    14     1 Diploma                   
## 4    18     1 No Qualification          
## 5    22     1 Postgraduate qualification
## 
## $`2`
## # A tibble: 20 x 3
##      row   col header 
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;  
##  1     3     2 15 - 24
##  2     4     2 25 - 44
##  3     5     2 45 - 64
##  4     6     2 65+    
##  5     7     2 15 - 24
##  6     8     2 25 - 44
##  7     9     2 45 - 64
##  8    10     2 65+    
##  9    11     2 15 - 24
## 10    12     2 25 - 44
## 11    13     2 45 - 64
## 12    14     2 65+    
## 13    15     2 15 - 24
## 14    16     2 25 - 44
## 15    17     2 45 - 64
## 16    18     2 65+    
## 17    19     2 15 - 24
## 18    20     2 25 - 44
## 19    21     2 45 - 64
## 20    22     2 65+</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">col_headers &lt;-</a>
<a class="sourceLine" id="cb23-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-4" title="4"><span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-5" title="5"><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)</a>
<a class="sourceLine" id="cb23-6" title="6">col_headers</a></code></pre></div>
<pre><code>## $`1`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     1     4 Female
## 2     1     6 Male  
## 
## $`2`
## # A tibble: 4 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     2     3 0 - 6 
## 2     2     4 7 - 10
## 3     2     5 0 - 6 
## 4     2     6 7 - 10</code></pre>
</div>
<div id="data-same-as-nnw-wnw" class="section level3">
<h3>Data (same as NNW WNW)</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">data_cells &lt;-</a>
<a class="sourceLine" id="cb25-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="st">  </span><span class="kw">select</span>(row, col, value)</a>
<a class="sourceLine" id="cb25-6" title="6">data_cells</a></code></pre></div>
<pre><code>## # A tibble: 72 x 3
##      row   col value
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1     3     3  7000
##  2     4     3 12000
##  3     5     3 10000
##  4     7     3 29000
##  5     8     3 34000
##  6     9     3 30000
##  7    10     3 12000
##  8    12     3 10000
##  9    13     3  6000
## 10    14     3  5000
## # … with 62 more rows</code></pre>
</div>
<div id="join-headers-to-data-different-from-nnw-wnw" class="section level3">
<h3>Join headers to data (different from NNW WNW)</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">data_cells &lt;-</a>
<a class="sourceLine" id="cb27-2" title="2"><span class="st">  </span>data_cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="st">  </span><span class="kw">enhead</span>(col_headers[[<span class="dv">1</span>]], <span class="st">&quot;NNE&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from NNW WNW</span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="st">  </span><span class="kw">enhead</span>(col_headers[[<span class="dv">2</span>]], <span class="st">&quot;N&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Same as NNW WNW</span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="st">  </span><span class="kw">enhead</span>(row_headers[[<span class="dv">1</span>]], <span class="st">&quot;WSW&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from NNW WNW</span></a>
<a class="sourceLine" id="cb27-6" title="6"><span class="st">  </span><span class="kw">enhead</span>(row_headers[[<span class="dv">2</span>]], <span class="st">&quot;W&quot;</span>) <span class="co"># Same as NNW WNW</span></a></code></pre></div>
</div>
<div id="result-1" class="section level3">
<h3>Result</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">data_cells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a></code></pre></div>
<pre><code>##    row col  value header.data header.header           header.data.data
## 1    3   3   7000      Female         0 - 6          Bachelor&#39;s degree
## 2    4   3  12000      Female         0 - 6          Bachelor&#39;s degree
## 3    5   3  10000      Female         0 - 6          Bachelor&#39;s degree
## 4    3   4  27000      Female        7 - 10          Bachelor&#39;s degree
## 5    4   4 137000      Female        7 - 10          Bachelor&#39;s degree
## 6    5   4  64000      Female        7 - 10          Bachelor&#39;s degree
## 7    6   4  18000      Female        7 - 10          Bachelor&#39;s degree
## 8    4   5   9000        Male         0 - 6          Bachelor&#39;s degree
## 9    5   5   7000        Male         0 - 6          Bachelor&#39;s degree
## 10   6   5   7000        Male         0 - 6          Bachelor&#39;s degree
## 11   3   6  13000        Male        7 - 10          Bachelor&#39;s degree
## 12   4   6  81000        Male        7 - 10          Bachelor&#39;s degree
## 13   5   6  66000        Male        7 - 10          Bachelor&#39;s degree
## 14   6   6  17000        Male        7 - 10          Bachelor&#39;s degree
## 15   7   3  29000      Female         0 - 6                Certificate
## 16   8   3  34000      Female         0 - 6                Certificate
## 17   9   3  30000      Female         0 - 6                Certificate
## 18  10   3  12000      Female         0 - 6                Certificate
## 19   7   4 161000      Female        7 - 10                Certificate
## 20   8   4 179000      Female        7 - 10                Certificate
## 21   9   4 210000      Female        7 - 10                Certificate
## 22  10   4  77000      Female        7 - 10                Certificate
## 23   7   5  30000        Male         0 - 6                Certificate
## 24   8   5  31000        Male         0 - 6                Certificate
## 25   9   5  23000        Male         0 - 6                Certificate
## 26  10   5   8000        Male         0 - 6                Certificate
## 27   7   6 190000        Male        7 - 10                Certificate
## 28   8   6 219000        Male        7 - 10                Certificate
## 29   9   6 199000        Male        7 - 10                Certificate
## 30  10   6 107000        Male        7 - 10                Certificate
## 31  12   3  10000      Female         0 - 6                    Diploma
## 32  13   3   6000      Female         0 - 6                    Diploma
## 33  14   3   5000      Female         0 - 6                    Diploma
## 34  11   4  14000      Female        7 - 10                    Diploma
## 35  12   4  66000      Female        7 - 10                    Diploma
## 36  13   4  68000      Female        7 - 10                    Diploma
## 37  14   4  41000      Female        7 - 10                    Diploma
## 38  11   5   9000        Male         0 - 6                    Diploma
## 39  12   5   8000        Male         0 - 6                    Diploma
## 40  13   5   5000        Male         0 - 6                    Diploma
## 41  14   5   1000        Male         0 - 6                    Diploma
## 42  11   6  11000        Male        7 - 10                    Diploma
## 43  12   6  47000        Male        7 - 10                    Diploma
## 44  13   6  58000        Male        7 - 10                    Diploma
## 45  14   6  34000        Male        7 - 10                    Diploma
## 46  15   3  10000      Female         0 - 6           No Qualification
## 47  16   3  11000      Female         0 - 6           No Qualification
## 48  17   3  19000      Female         0 - 6           No Qualification
## 49  18   3  16000      Female         0 - 6           No Qualification
## 50  15   4  43000      Female        7 - 10           No Qualification
## 51  16   4  36000      Female        7 - 10           No Qualification
## 52  17   4  91000      Female        7 - 10           No Qualification
## 53  18   4 118000      Female        7 - 10           No Qualification
## 54  15   5  12000        Male         0 - 6           No Qualification
## 55  16   5  21000        Male         0 - 6           No Qualification
## 56  17   5  17000        Male         0 - 6           No Qualification
## 57  18   5   9000        Male         0 - 6           No Qualification
## 58  15   6  37000        Male        7 - 10           No Qualification
## 59  16   6  50000        Male        7 - 10           No Qualification
## 60  17   6  75000        Male        7 - 10           No Qualification
## 61  18   6  66000        Male        7 - 10           No Qualification
## 62  20   3   5000      Female         0 - 6 Postgraduate qualification
## 63  21   3   6000      Female         0 - 6 Postgraduate qualification
## 64  19   4   6000      Female        7 - 10 Postgraduate qualification
## 65  20   4  86000      Female        7 - 10 Postgraduate qualification
## 66  21   4  55000      Female        7 - 10 Postgraduate qualification
## 67  22   4  13000      Female        7 - 10 Postgraduate qualification
## 68  20   5   7000        Male         0 - 6 Postgraduate qualification
## 69  21   5   6000        Male         0 - 6 Postgraduate qualification
## 70  20   6  60000        Male        7 - 10 Postgraduate qualification
## 71  21   6  68000        Male        7 - 10 Postgraduate qualification
## 72  22   6  18000        Male        7 - 10 Postgraduate qualification
##    header.header.header
## 1               15 - 24
## 2               25 - 44
## 3               45 - 64
## 4               15 - 24
## 5               25 - 44
## 6               45 - 64
## 7                   65+
## 8               25 - 44
## 9               45 - 64
## 10                  65+
## 11              15 - 24
## 12              25 - 44
## 13              45 - 64
## 14                  65+
## 15              15 - 24
## 16              25 - 44
## 17              45 - 64
## 18                  65+
## 19              15 - 24
## 20              25 - 44
## 21              45 - 64
## 22                  65+
## 23              15 - 24
## 24              25 - 44
## 25              45 - 64
## 26                  65+
## 27              15 - 24
## 28              25 - 44
## 29              45 - 64
## 30                  65+
## 31              25 - 44
## 32              45 - 64
## 33                  65+
## 34              15 - 24
## 35              25 - 44
## 36              45 - 64
## 37                  65+
## 38              15 - 24
## 39              25 - 44
## 40              45 - 64
## 41                  65+
## 42              15 - 24
## 43              25 - 44
## 44              45 - 64
## 45                  65+
## 46              15 - 24
## 47              25 - 44
## 48              45 - 64
## 49                  65+
## 50              15 - 24
## 51              25 - 44
## 52              45 - 64
## 53                  65+
## 54              15 - 24
## 55              25 - 44
## 56              45 - 64
## 57                  65+
## 58              15 - 24
## 59              25 - 44
## 60              45 - 64
## 61                  65+
## 62              25 - 44
## 63              45 - 64
## 64              15 - 24
## 65              25 - 44
## 66              45 - 64
## 67                  65+
## 68              25 - 44
## 69              45 - 64
## 70              25 - 44
## 71              45 - 64
## 72                  65+</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">NNE_WSW &lt;-<span class="st"> </span>data_cells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(row, col)</a></code></pre></div>
</div>
</div>
<div id="sse-ese-example" class="section level2">
<h2>SSE ESE example</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">cells &lt;-<span class="st"> </span><span class="kw">as_cells</span>(purpose<span class="op">$</span><span class="st">`</span><span class="dt">SSE ESE</span><span class="st">`</span>)</a></code></pre></div>
<div id="headers-1" class="section level3">
<h3>Headers</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">row_headers &lt;-</a>
<a class="sourceLine" id="cb32-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb32-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb32-4" title="4"><span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb32-5" title="5"><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)</a>
<a class="sourceLine" id="cb32-6" title="6">row_headers</a></code></pre></div>
<pre><code>## $`5`
## # A tibble: 20 x 3
##      row   col header 
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;  
##  1     1     5 15 - 24
##  2     2     5 25 - 44
##  3     3     5 45 - 64
##  4     4     5 65+    
##  5     5     5 15 - 24
##  6     6     5 25 - 44
##  7     7     5 45 - 64
##  8     8     5 65+    
##  9     9     5 15 - 24
## 10    10     5 25 - 44
## 11    11     5 45 - 64
## 12    12     5 65+    
## 13    13     5 15 - 24
## 14    14     5 25 - 44
## 15    15     5 45 - 64
## 16    16     5 65+    
## 17    17     5 15 - 24
## 18    18     5 25 - 44
## 19    19     5 45 - 64
## 20    20     5 65+    
## 
## $`6`
## # A tibble: 5 x 3
##     row   col header                    
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;                     
## 1     4     6 Bachelor&#39;s degree         
## 2     8     6 Certificate               
## 3    12     6 Diploma                   
## 4    16     6 No Qualification          
## 5    20     6 Postgraduate qualification</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">col_headers &lt;-</a>
<a class="sourceLine" id="cb34-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">21</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-5" title="5"><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)</a>
<a class="sourceLine" id="cb34-6" title="6">col_headers</a></code></pre></div>
<pre><code>## $`21`
## # A tibble: 4 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1    21     1 0 - 6 
## 2    21     2 7 - 10
## 3    21     3 0 - 6 
## 4    21     4 7 - 10
## 
## $`22`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1    22     2 Female
## 2    22     4 Male</code></pre>
</div>
<div id="data-1" class="section level3">
<h3>Data</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">data_cells &lt;-</a>
<a class="sourceLine" id="cb36-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">20</span>, col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">4</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-5" title="5"><span class="st">  </span><span class="kw">select</span>(row, col, value)</a>
<a class="sourceLine" id="cb36-6" title="6">data_cells</a></code></pre></div>
<pre><code>## # A tibble: 72 x 3
##      row   col value
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1     1     1  7000
##  2     2     1 12000
##  3     3     1 10000
##  4     5     1 29000
##  5     6     1 34000
##  6     7     1 30000
##  7     8     1 12000
##  8    10     1 10000
##  9    11     1  6000
## 10    12     1  5000
## # … with 62 more rows</code></pre>
</div>
<div id="join-headers-to-data-1" class="section level3">
<h3>Join headers to data</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">data_cells &lt;-</a>
<a class="sourceLine" id="cb38-2" title="2"><span class="st">  </span>data_cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-3" title="3"><span class="st">  </span><span class="kw">enhead</span>(col_headers[[<span class="dv">2</span>]], <span class="st">&quot;SSE&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-4" title="4"><span class="st">  </span><span class="kw">enhead</span>(col_headers[[<span class="dv">1</span>]], <span class="st">&quot;S&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-5" title="5"><span class="st">  </span><span class="kw">enhead</span>(row_headers[[<span class="dv">2</span>]], <span class="st">&quot;ESE&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-6" title="6"><span class="st">  </span><span class="kw">enhead</span>(row_headers[[<span class="dv">1</span>]], <span class="st">&quot;E&quot;</span>)</a></code></pre></div>
</div>
<div id="result-2" class="section level3">
<h3>Result</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">data_cells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a></code></pre></div>
<pre><code>##    row col  value header.data header.header           header.data.data
## 1    1   1   7000      Female         0 - 6          Bachelor&#39;s degree
## 2    2   1  12000      Female         0 - 6          Bachelor&#39;s degree
## 3    3   1  10000      Female         0 - 6          Bachelor&#39;s degree
## 4    1   2  27000      Female        7 - 10          Bachelor&#39;s degree
## 5    2   2 137000      Female        7 - 10          Bachelor&#39;s degree
## 6    3   2  64000      Female        7 - 10          Bachelor&#39;s degree
## 7    4   2  18000      Female        7 - 10          Bachelor&#39;s degree
## 8    2   3   9000        Male         0 - 6          Bachelor&#39;s degree
## 9    3   3   7000        Male         0 - 6          Bachelor&#39;s degree
## 10   4   3   7000        Male         0 - 6          Bachelor&#39;s degree
## 11   1   4  13000        Male        7 - 10          Bachelor&#39;s degree
## 12   2   4  81000        Male        7 - 10          Bachelor&#39;s degree
## 13   3   4  66000        Male        7 - 10          Bachelor&#39;s degree
## 14   4   4  17000        Male        7 - 10          Bachelor&#39;s degree
## 15   5   1  29000      Female         0 - 6                Certificate
## 16   6   1  34000      Female         0 - 6                Certificate
## 17   7   1  30000      Female         0 - 6                Certificate
## 18   8   1  12000      Female         0 - 6                Certificate
## 19   5   2 161000      Female        7 - 10                Certificate
## 20   6   2 179000      Female        7 - 10                Certificate
## 21   7   2 210000      Female        7 - 10                Certificate
## 22   8   2  77000      Female        7 - 10                Certificate
## 23   5   3  30000        Male         0 - 6                Certificate
## 24   6   3  31000        Male         0 - 6                Certificate
## 25   7   3  23000        Male         0 - 6                Certificate
## 26   8   3   8000        Male         0 - 6                Certificate
## 27   5   4 190000        Male        7 - 10                Certificate
## 28   6   4 219000        Male        7 - 10                Certificate
## 29   7   4 199000        Male        7 - 10                Certificate
## 30   8   4 107000        Male        7 - 10                Certificate
## 31  10   1  10000      Female         0 - 6                    Diploma
## 32  11   1   6000      Female         0 - 6                    Diploma
## 33  12   1   5000      Female         0 - 6                    Diploma
## 34   9   2  14000      Female        7 - 10                    Diploma
## 35  10   2  66000      Female        7 - 10                    Diploma
## 36  11   2  68000      Female        7 - 10                    Diploma
## 37  12   2  41000      Female        7 - 10                    Diploma
## 38   9   3   9000        Male         0 - 6                    Diploma
## 39  10   3   8000        Male         0 - 6                    Diploma
## 40  11   3   5000        Male         0 - 6                    Diploma
## 41  12   3   1000        Male         0 - 6                    Diploma
## 42   9   4  11000        Male        7 - 10                    Diploma
## 43  10   4  47000        Male        7 - 10                    Diploma
## 44  11   4  58000        Male        7 - 10                    Diploma
## 45  12   4  34000        Male        7 - 10                    Diploma
## 46  13   1  10000      Female         0 - 6           No Qualification
## 47  14   1  11000      Female         0 - 6           No Qualification
## 48  15   1  19000      Female         0 - 6           No Qualification
## 49  16   1  16000      Female         0 - 6           No Qualification
## 50  13   2  43000      Female        7 - 10           No Qualification
## 51  14   2  36000      Female        7 - 10           No Qualification
## 52  15   2  91000      Female        7 - 10           No Qualification
## 53  16   2 118000      Female        7 - 10           No Qualification
## 54  13   3  12000        Male         0 - 6           No Qualification
## 55  14   3  21000        Male         0 - 6           No Qualification
## 56  15   3  17000        Male         0 - 6           No Qualification
## 57  16   3   9000        Male         0 - 6           No Qualification
## 58  13   4  37000        Male        7 - 10           No Qualification
## 59  14   4  50000        Male        7 - 10           No Qualification
## 60  15   4  75000        Male        7 - 10           No Qualification
## 61  16   4  66000        Male        7 - 10           No Qualification
## 62  18   1   5000      Female         0 - 6 Postgraduate qualification
## 63  19   1   6000      Female         0 - 6 Postgraduate qualification
## 64  17   2   6000      Female        7 - 10 Postgraduate qualification
## 65  18   2  86000      Female        7 - 10 Postgraduate qualification
## 66  19   2  55000      Female        7 - 10 Postgraduate qualification
## 67  20   2  13000      Female        7 - 10 Postgraduate qualification
## 68  18   3   7000        Male         0 - 6 Postgraduate qualification
## 69  19   3   6000        Male         0 - 6 Postgraduate qualification
## 70  18   4  60000        Male        7 - 10 Postgraduate qualification
## 71  19   4  68000        Male        7 - 10 Postgraduate qualification
## 72  20   4  18000        Male        7 - 10 Postgraduate qualification
##    header.header.header
## 1               15 - 24
## 2               25 - 44
## 3               45 - 64
## 4               15 - 24
## 5               25 - 44
## 6               45 - 64
## 7                   65+
## 8               25 - 44
## 9               45 - 64
## 10                  65+
## 11              15 - 24
## 12              25 - 44
## 13              45 - 64
## 14                  65+
## 15              15 - 24
## 16              25 - 44
## 17              45 - 64
## 18                  65+
## 19              15 - 24
## 20              25 - 44
## 21              45 - 64
## 22                  65+
## 23              15 - 24
## 24              25 - 44
## 25              45 - 64
## 26                  65+
## 27              15 - 24
## 28              25 - 44
## 29              45 - 64
## 30                  65+
## 31              25 - 44
## 32              45 - 64
## 33                  65+
## 34              15 - 24
## 35              25 - 44
## 36              45 - 64
## 37                  65+
## 38              15 - 24
## 39              25 - 44
## 40              45 - 64
## 41                  65+
## 42              15 - 24
## 43              25 - 44
## 44              45 - 64
## 45                  65+
## 46              15 - 24
## 47              25 - 44
## 48              45 - 64
## 49                  65+
## 50              15 - 24
## 51              25 - 44
## 52              45 - 64
## 53                  65+
## 54              15 - 24
## 55              25 - 44
## 56              45 - 64
## 57                  65+
## 58              15 - 24
## 59              25 - 44
## 60              45 - 64
## 61                  65+
## 62              25 - 44
## 63              45 - 64
## 64              15 - 24
## 65              25 - 44
## 66              45 - 64
## 67                  65+
## 68              25 - 44
## 69              45 - 64
## 70              25 - 44
## 71              45 - 64
## 72                  65+</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">SSE_ESE &lt;-<span class="st"> </span>data_cells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(row, col)</a></code></pre></div>
</div>
</div>
<div id="ssw-ene-example" class="section level2">
<h2>SSW ENE example</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">cells &lt;-<span class="st"> </span><span class="kw">as_cells</span>(purpose<span class="op">$</span><span class="st">`</span><span class="dt">SSW ENE</span><span class="st">`</span>)</a></code></pre></div>
<div id="headers-same-as-sse-ese" class="section level3">
<h3>Headers (same as SSE ESE)</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">row_headers &lt;-</a>
<a class="sourceLine" id="cb43-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-4" title="4"><span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-5" title="5"><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)</a>
<a class="sourceLine" id="cb43-6" title="6">row_headers</a></code></pre></div>
<pre><code>## $`5`
## # A tibble: 20 x 3
##      row   col header 
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;  
##  1     1     5 15 - 24
##  2     2     5 25 - 44
##  3     3     5 45 - 64
##  4     4     5 65+    
##  5     5     5 15 - 24
##  6     6     5 25 - 44
##  7     7     5 45 - 64
##  8     8     5 65+    
##  9     9     5 15 - 24
## 10    10     5 25 - 44
## 11    11     5 45 - 64
## 12    12     5 65+    
## 13    13     5 15 - 24
## 14    14     5 25 - 44
## 15    15     5 45 - 64
## 16    16     5 65+    
## 17    17     5 15 - 24
## 18    18     5 25 - 44
## 19    19     5 45 - 64
## 20    20     5 65+    
## 
## $`6`
## # A tibble: 5 x 3
##     row   col header                    
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;                     
## 1     1     6 Bachelor&#39;s degree         
## 2     5     6 Certificate               
## 3     9     6 Diploma                   
## 4    13     6 No Qualification          
## 5    17     6 Postgraduate qualification</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">col_headers &lt;-</a>
<a class="sourceLine" id="cb45-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb45-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">21</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb45-4" title="4"><span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb45-5" title="5"><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)</a>
<a class="sourceLine" id="cb45-6" title="6">col_headers</a></code></pre></div>
<pre><code>## $`21`
## # A tibble: 4 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1    21     1 0 - 6 
## 2    21     2 7 - 10
## 3    21     3 0 - 6 
## 4    21     4 7 - 10
## 
## $`22`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1    22     1 Female
## 2    22     3 Male</code></pre>
</div>
<div id="data-same-as-sse-ese" class="section level3">
<h3>Data (same as SSE ESE)</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">data_cells &lt;-</a>
<a class="sourceLine" id="cb47-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">20</span>, col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">4</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-5" title="5"><span class="st">  </span><span class="kw">select</span>(row, col, value)</a>
<a class="sourceLine" id="cb47-6" title="6">data_cells</a></code></pre></div>
<pre><code>## # A tibble: 72 x 3
##      row   col value
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1     1     1  7000
##  2     2     1 12000
##  3     3     1 10000
##  4     5     1 29000
##  5     6     1 34000
##  6     7     1 30000
##  7     8     1 12000
##  8    10     1 10000
##  9    11     1  6000
## 10    12     1  5000
## # … with 62 more rows</code></pre>
</div>
<div id="join-headers-to-data-2" class="section level3">
<h3>Join headers to data</h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">data_cells &lt;-</a>
<a class="sourceLine" id="cb49-2" title="2"><span class="st">  </span>data_cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb49-3" title="3"><span class="st">  </span><span class="kw">enhead</span>(col_headers[[<span class="dv">2</span>]], <span class="st">&quot;SSW&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from SSE ESE</span></a>
<a class="sourceLine" id="cb49-4" title="4"><span class="st">  </span><span class="kw">enhead</span>(col_headers[[<span class="dv">1</span>]], <span class="st">&quot;S&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Same as SSE ESE</span></a>
<a class="sourceLine" id="cb49-5" title="5"><span class="st">  </span><span class="kw">enhead</span>(row_headers[[<span class="dv">2</span>]], <span class="st">&quot;ENE&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from SSE ESE</span></a>
<a class="sourceLine" id="cb49-6" title="6"><span class="st">  </span><span class="kw">enhead</span>(row_headers[[<span class="dv">1</span>]], <span class="st">&quot;E&quot;</span>) <span class="co"># Same as SSE ESE</span></a></code></pre></div>
</div>
<div id="result-3" class="section level3">
<h3>Result</h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">data_cells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a></code></pre></div>
<pre><code>##    row col  value header.data header.header           header.data.data
## 1    1   1   7000      Female         0 - 6          Bachelor&#39;s degree
## 2    2   1  12000      Female         0 - 6          Bachelor&#39;s degree
## 3    3   1  10000      Female         0 - 6          Bachelor&#39;s degree
## 4    1   2  27000      Female        7 - 10          Bachelor&#39;s degree
## 5    2   2 137000      Female        7 - 10          Bachelor&#39;s degree
## 6    3   2  64000      Female        7 - 10          Bachelor&#39;s degree
## 7    4   2  18000      Female        7 - 10          Bachelor&#39;s degree
## 8    2   3   9000        Male         0 - 6          Bachelor&#39;s degree
## 9    3   3   7000        Male         0 - 6          Bachelor&#39;s degree
## 10   4   3   7000        Male         0 - 6          Bachelor&#39;s degree
## 11   1   4  13000        Male        7 - 10          Bachelor&#39;s degree
## 12   2   4  81000        Male        7 - 10          Bachelor&#39;s degree
## 13   3   4  66000        Male        7 - 10          Bachelor&#39;s degree
## 14   4   4  17000        Male        7 - 10          Bachelor&#39;s degree
## 15   5   1  29000      Female         0 - 6                Certificate
## 16   6   1  34000      Female         0 - 6                Certificate
## 17   7   1  30000      Female         0 - 6                Certificate
## 18   8   1  12000      Female         0 - 6                Certificate
## 19   5   2 161000      Female        7 - 10                Certificate
## 20   6   2 179000      Female        7 - 10                Certificate
## 21   7   2 210000      Female        7 - 10                Certificate
## 22   8   2  77000      Female        7 - 10                Certificate
## 23   5   3  30000        Male         0 - 6                Certificate
## 24   6   3  31000        Male         0 - 6                Certificate
## 25   7   3  23000        Male         0 - 6                Certificate
## 26   8   3   8000        Male         0 - 6                Certificate
## 27   5   4 190000        Male        7 - 10                Certificate
## 28   6   4 219000        Male        7 - 10                Certificate
## 29   7   4 199000        Male        7 - 10                Certificate
## 30   8   4 107000        Male        7 - 10                Certificate
## 31  10   1  10000      Female         0 - 6                    Diploma
## 32  11   1   6000      Female         0 - 6                    Diploma
## 33  12   1   5000      Female         0 - 6                    Diploma
## 34   9   2  14000      Female        7 - 10                    Diploma
## 35  10   2  66000      Female        7 - 10                    Diploma
## 36  11   2  68000      Female        7 - 10                    Diploma
## 37  12   2  41000      Female        7 - 10                    Diploma
## 38   9   3   9000        Male         0 - 6                    Diploma
## 39  10   3   8000        Male         0 - 6                    Diploma
## 40  11   3   5000        Male         0 - 6                    Diploma
## 41  12   3   1000        Male         0 - 6                    Diploma
## 42   9   4  11000        Male        7 - 10                    Diploma
## 43  10   4  47000        Male        7 - 10                    Diploma
## 44  11   4  58000        Male        7 - 10                    Diploma
## 45  12   4  34000        Male        7 - 10                    Diploma
## 46  13   1  10000      Female         0 - 6           No Qualification
## 47  14   1  11000      Female         0 - 6           No Qualification
## 48  15   1  19000      Female         0 - 6           No Qualification
## 49  16   1  16000      Female         0 - 6           No Qualification
## 50  13   2  43000      Female        7 - 10           No Qualification
## 51  14   2  36000      Female        7 - 10           No Qualification
## 52  15   2  91000      Female        7 - 10           No Qualification
## 53  16   2 118000      Female        7 - 10           No Qualification
## 54  13   3  12000        Male         0 - 6           No Qualification
## 55  14   3  21000        Male         0 - 6           No Qualification
## 56  15   3  17000        Male         0 - 6           No Qualification
## 57  16   3   9000        Male         0 - 6           No Qualification
## 58  13   4  37000        Male        7 - 10           No Qualification
## 59  14   4  50000        Male        7 - 10           No Qualification
## 60  15   4  75000        Male        7 - 10           No Qualification
## 61  16   4  66000        Male        7 - 10           No Qualification
## 62  18   1   5000      Female         0 - 6 Postgraduate qualification
## 63  19   1   6000      Female         0 - 6 Postgraduate qualification
## 64  17   2   6000      Female        7 - 10 Postgraduate qualification
## 65  18   2  86000      Female        7 - 10 Postgraduate qualification
## 66  19   2  55000      Female        7 - 10 Postgraduate qualification
## 67  20   2  13000      Female        7 - 10 Postgraduate qualification
## 68  18   3   7000        Male         0 - 6 Postgraduate qualification
## 69  19   3   6000        Male         0 - 6 Postgraduate qualification
## 70  18   4  60000        Male        7 - 10 Postgraduate qualification
## 71  19   4  68000        Male        7 - 10 Postgraduate qualification
## 72  20   4  18000        Male        7 - 10 Postgraduate qualification
##    header.header.header
## 1               15 - 24
## 2               25 - 44
## 3               45 - 64
## 4               15 - 24
## 5               25 - 44
## 6               45 - 64
## 7                   65+
## 8               25 - 44
## 9               45 - 64
## 10                  65+
## 11              15 - 24
## 12              25 - 44
## 13              45 - 64
## 14                  65+
## 15              15 - 24
## 16              25 - 44
## 17              45 - 64
## 18                  65+
## 19              15 - 24
## 20              25 - 44
## 21              45 - 64
## 22                  65+
## 23              15 - 24
## 24              25 - 44
## 25              45 - 64
## 26                  65+
## 27              15 - 24
## 28              25 - 44
## 29              45 - 64
## 30                  65+
## 31              25 - 44
## 32              45 - 64
## 33                  65+
## 34              15 - 24
## 35              25 - 44
## 36              45 - 64
## 37                  65+
## 38              15 - 24
## 39              25 - 44
## 40              45 - 64
## 41                  65+
## 42              15 - 24
## 43              25 - 44
## 44              45 - 64
## 45                  65+
## 46              15 - 24
## 47              25 - 44
## 48              45 - 64
## 49                  65+
## 50              15 - 24
## 51              25 - 44
## 52              45 - 64
## 53                  65+
## 54              15 - 24
## 55              25 - 44
## 56              45 - 64
## 57                  65+
## 58              15 - 24
## 59              25 - 44
## 60              45 - 64
## 61                  65+
## 62              25 - 44
## 63              45 - 64
## 64              15 - 24
## 65              25 - 44
## 66              45 - 64
## 67                  65+
## 68              25 - 44
## 69              45 - 64
## 70              25 - 44
## 71              45 - 64
## 72                  65+</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">SSW_ENE &lt;-<span class="st"> </span>data_cells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(row, col)</a></code></pre></div>
</div>
</div>
<div id="check-that-all-sheets-are-parsed-correctly" class="section level2">
<h2>Check that all sheets are parsed correctly</h2>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="kw">identical</span>(NNW_WNW, NNE_WSW)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">identical</span>(SSW_ENE, SSE_ESE)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">identical</span>(NNW_WNW[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>], SSW_ENE[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>])</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="above-left-example" class="section level2">
<h2>ABOVE LEFT example</h2>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1">cells &lt;-<span class="st"> </span><span class="kw">as_cells</span>(purpose<span class="op">$</span><span class="st">`</span><span class="dt">ABOVE LEFT</span><span class="st">`</span>)</a></code></pre></div>
<div id="headers-2" class="section level3">
<h3>Headers</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1">row_headers &lt;-</a>
<a class="sourceLine" id="cb60-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb60-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb60-4" title="4"><span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb60-5" title="5"><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)</a>
<a class="sourceLine" id="cb60-6" title="6">row_headers</a></code></pre></div>
<pre><code>## $`1`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     5     1 Female
## 2    10     1 Male  
## 
## $`2`
## # A tibble: 10 x 3
##      row   col header                    
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;                     
##  1     3     2 Bachelor&#39;s degree         
##  2     4     2 Certificate               
##  3     5     2 Diploma                   
##  4     6     2 No Qualification          
##  5     7     2 Postgraduate qualification
##  6     8     2 Bachelor&#39;s degree         
##  7     9     2 Certificate               
##  8    10     2 Diploma                   
##  9    11     2 No Qualification          
## 10    12     2 Postgraduate qualification</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">col_headers &lt;-</a>
<a class="sourceLine" id="cb62-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb62-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb62-4" title="4"><span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb62-5" title="5"><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)</a>
<a class="sourceLine" id="cb62-6" title="6">col_headers</a></code></pre></div>
<pre><code>## $`1`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     1     4 0 - 6 
## 2     1     7 7 - 10
## 
## $`2`
## # A tibble: 6 x 3
##     row   col header 
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;  
## 1     2     3 15 - 24
## 2     2     4 25 - 44
## 3     2     5 45 - 64
## 4     2     6 15 - 24
## 5     2     7 25 - 44
## 6     2     8 45 - 64</code></pre>
</div>
<div id="data-2" class="section level3">
<h3>Data</h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">data_cells &lt;-</a>
<a class="sourceLine" id="cb64-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-5" title="5"><span class="st">  </span><span class="kw">select</span>(row, col, value)</a>
<a class="sourceLine" id="cb64-6" title="6">data_cells</a></code></pre></div>
<pre><code>## # A tibble: 55 x 3
##      row   col value
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1     3     3  7000
##  2     4     3 29000
##  3     6     3 10000
##  4     9     3 30000
##  5    10     3  9000
##  6    11     3 12000
##  7     3     4 12000
##  8     4     4 34000
##  9     5     4 10000
## 10     6     4 11000
## # … with 45 more rows</code></pre>
</div>
<div id="join-headers-to-data-3" class="section level3">
<h3>Join headers to data</h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">data_cells &lt;-</a>
<a class="sourceLine" id="cb66-2" title="2"><span class="st">  </span>data_cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb66-3" title="3"><span class="st">  </span><span class="kw">enhead</span>(col_headers[[<span class="dv">1</span>]], <span class="st">&quot;ABOVE&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from SSE ESE</span></a>
<a class="sourceLine" id="cb66-4" title="4"><span class="st">  </span><span class="kw">enhead</span>(col_headers[[<span class="dv">2</span>]], <span class="st">&quot;N&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Same as SSE ESE</span></a>
<a class="sourceLine" id="cb66-5" title="5"><span class="st">  </span><span class="kw">enhead</span>(row_headers[[<span class="dv">1</span>]], <span class="st">&quot;LEFT&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from SSE ESE</span></a>
<a class="sourceLine" id="cb66-6" title="6"><span class="st">  </span><span class="kw">enhead</span>(row_headers[[<span class="dv">2</span>]], <span class="st">&quot;W&quot;</span>) <span class="co"># Same as SSE ESE</span></a></code></pre></div>
</div>
<div id="result-4" class="section level3">
<h3>Result</h3>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">data_cells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a></code></pre></div>
<pre><code>##    row col  value header.data header.header header.data.data
## 1    3   3   7000       0 - 6       15 - 24           Female
## 2    4   3  29000       0 - 6       15 - 24           Female
## 3    6   3  10000       0 - 6       15 - 24           Female
## 4    3   4  12000       0 - 6       25 - 44           Female
## 5    4   4  34000       0 - 6       25 - 44           Female
## 6    5   4  10000       0 - 6       25 - 44           Female
## 7    6   4  11000       0 - 6       25 - 44           Female
## 8    7   4   5000       0 - 6       25 - 44           Female
## 9    3   5  10000       0 - 6       45 - 64           Female
## 10   4   5  30000       0 - 6       45 - 64           Female
## 11   5   5   6000       0 - 6       45 - 64           Female
## 12   6   5  19000       0 - 6       45 - 64           Female
## 13   7   5   6000       0 - 6       45 - 64           Female
## 14   3   6  27000      7 - 10       15 - 24           Female
## 15   4   6 161000      7 - 10       15 - 24           Female
## 16   5   6  14000      7 - 10       15 - 24           Female
## 17   6   6  43000      7 - 10       15 - 24           Female
## 18   7   6   6000      7 - 10       15 - 24           Female
## 19   3   7 137000      7 - 10       25 - 44           Female
## 20   4   7 179000      7 - 10       25 - 44           Female
## 21   5   7  66000      7 - 10       25 - 44           Female
## 22   6   7  36000      7 - 10       25 - 44           Female
## 23   7   7  86000      7 - 10       25 - 44           Female
## 24   3   8  64000      7 - 10       45 - 64           Female
## 25   4   8 210000      7 - 10       45 - 64           Female
## 26   5   8  68000      7 - 10       45 - 64           Female
## 27   6   8  91000      7 - 10       45 - 64           Female
## 28   7   8  55000      7 - 10       45 - 64           Female
## 29   9   3  30000       0 - 6       15 - 24             Male
## 30  10   3   9000       0 - 6       15 - 24             Male
## 31  11   3  12000       0 - 6       15 - 24             Male
## 32   8   4   9000       0 - 6       25 - 44             Male
## 33   9   4  31000       0 - 6       25 - 44             Male
## 34  10   4   8000       0 - 6       25 - 44             Male
## 35  11   4  21000       0 - 6       25 - 44             Male
## 36  12   4   7000       0 - 6       25 - 44             Male
## 37   8   5   7000       0 - 6       45 - 64             Male
## 38   9   5  23000       0 - 6       45 - 64             Male
## 39  10   5   5000       0 - 6       45 - 64             Male
## 40  11   5  17000       0 - 6       45 - 64             Male
## 41  12   5   6000       0 - 6       45 - 64             Male
## 42   8   6  13000      7 - 10       15 - 24             Male
## 43   9   6 190000      7 - 10       15 - 24             Male
## 44  10   6  11000      7 - 10       15 - 24             Male
## 45  11   6  37000      7 - 10       15 - 24             Male
## 46   8   7  81000      7 - 10       25 - 44             Male
## 47   9   7 219000      7 - 10       25 - 44             Male
## 48  10   7  47000      7 - 10       25 - 44             Male
## 49  11   7  50000      7 - 10       25 - 44             Male
## 50  12   7  60000      7 - 10       25 - 44             Male
## 51   8   8  66000      7 - 10       45 - 64             Male
## 52   9   8 199000      7 - 10       45 - 64             Male
## 53  10   8  58000      7 - 10       45 - 64             Male
## 54  11   8  75000      7 - 10       45 - 64             Male
## 55  12   8  68000      7 - 10       45 - 64             Male
##          header.header.header
## 1           Bachelor&#39;s degree
## 2                 Certificate
## 3            No Qualification
## 4           Bachelor&#39;s degree
## 5                 Certificate
## 6                     Diploma
## 7            No Qualification
## 8  Postgraduate qualification
## 9           Bachelor&#39;s degree
## 10                Certificate
## 11                    Diploma
## 12           No Qualification
## 13 Postgraduate qualification
## 14          Bachelor&#39;s degree
## 15                Certificate
## 16                    Diploma
## 17           No Qualification
## 18 Postgraduate qualification
## 19          Bachelor&#39;s degree
## 20                Certificate
## 21                    Diploma
## 22           No Qualification
## 23 Postgraduate qualification
## 24          Bachelor&#39;s degree
## 25                Certificate
## 26                    Diploma
## 27           No Qualification
## 28 Postgraduate qualification
## 29                Certificate
## 30                    Diploma
## 31           No Qualification
## 32          Bachelor&#39;s degree
## 33                Certificate
## 34                    Diploma
## 35           No Qualification
## 36 Postgraduate qualification
## 37          Bachelor&#39;s degree
## 38                Certificate
## 39                    Diploma
## 40           No Qualification
## 41 Postgraduate qualification
## 42          Bachelor&#39;s degree
## 43                Certificate
## 44                    Diploma
## 45           No Qualification
## 46          Bachelor&#39;s degree
## 47                Certificate
## 48                    Diploma
## 49           No Qualification
## 50 Postgraduate qualification
## 51          Bachelor&#39;s degree
## 52                Certificate
## 53                    Diploma
## 54           No Qualification
## 55 Postgraduate qualification</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1">ABOVE_LEFT &lt;-<span class="st"> </span>data_cells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(row, col)</a></code></pre></div>
</div>
</div>
<div id="below-right-example" class="section level2">
<h2>BELOW RIGHT example</h2>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1">cells &lt;-<span class="st"> </span><span class="kw">as_cells</span>(purpose<span class="op">$</span><span class="st">`</span><span class="dt">BELOW RIGHT</span><span class="st">`</span>)</a></code></pre></div>
<div id="headers-3" class="section level3">
<h3>Headers</h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1">row_headers &lt;-</a>
<a class="sourceLine" id="cb71-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb71-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">7</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb71-4" title="4"><span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb71-5" title="5"><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)</a>
<a class="sourceLine" id="cb71-6" title="6">row_headers</a></code></pre></div>
<pre><code>## $`7`
## # A tibble: 10 x 3
##      row   col header                    
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;                     
##  1     1     7 Bachelor&#39;s degree         
##  2     2     7 Certificate               
##  3     3     7 Diploma                   
##  4     4     7 No Qualification          
##  5     5     7 Postgraduate qualification
##  6     6     7 Bachelor&#39;s degree         
##  7     7     7 Certificate               
##  8     8     7 Diploma                   
##  9     9     7 No Qualification          
## 10    10     7 Postgraduate qualification
## 
## $`8`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     3     8 Female
## 2     8     8 Male</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1">col_headers &lt;-</a>
<a class="sourceLine" id="cb73-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb73-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">11</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb73-4" title="4"><span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> chr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb73-5" title="5"><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)</a>
<a class="sourceLine" id="cb73-6" title="6">col_headers</a></code></pre></div>
<pre><code>## $`11`
## # A tibble: 6 x 3
##     row   col header 
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;  
## 1    11     1 15 - 24
## 2    11     2 25 - 44
## 3    11     3 45 - 64
## 4    11     4 15 - 24
## 5    11     5 25 - 44
## 6    11     6 45 - 64
## 
## $`12`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1    12     2 0 - 6 
## 2    12     5 7 - 10</code></pre>
</div>
<div id="data-3" class="section level3">
<h3>Data</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">data_cells &lt;-</a>
<a class="sourceLine" id="cb75-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>, col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">6</span>, <span class="op">!</span><span class="kw">is.na</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(chr)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-5" title="5"><span class="st">  </span><span class="kw">select</span>(row, col, value)</a>
<a class="sourceLine" id="cb75-6" title="6">data_cells</a></code></pre></div>
<pre><code>## # A tibble: 55 x 3
##      row   col value
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1     1     1  7000
##  2     2     1 29000
##  3     4     1 10000
##  4     7     1 30000
##  5     8     1  9000
##  6     9     1 12000
##  7     1     2 12000
##  8     2     2 34000
##  9     3     2 10000
## 10     4     2 11000
## # … with 45 more rows</code></pre>
</div>
<div id="join-headers-to-data-4" class="section level3">
<h3>Join headers to data</h3>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1">data_cells &lt;-</a>
<a class="sourceLine" id="cb77-2" title="2"><span class="st">  </span>data_cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-3" title="3"><span class="st">  </span><span class="kw">enhead</span>(col_headers[[<span class="dv">2</span>]], <span class="st">&quot;BELOW&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-4" title="4"><span class="st">  </span><span class="kw">enhead</span>(col_headers[[<span class="dv">1</span>]], <span class="st">&quot;S&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-5" title="5"><span class="st">  </span><span class="kw">enhead</span>(row_headers[[<span class="dv">2</span>]], <span class="st">&quot;RIGHT&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-6" title="6"><span class="st">  </span><span class="kw">enhead</span>(row_headers[[<span class="dv">1</span>]], <span class="st">&quot;E&quot;</span>)</a></code></pre></div>
</div>
<div id="result-5" class="section level3">
<h3>Result</h3>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1">data_cells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a></code></pre></div>
<pre><code>##    row col  value header.data header.header header.data.data
## 1    1   1   7000       0 - 6       15 - 24           Female
## 2    2   1  29000       0 - 6       15 - 24           Female
## 3    4   1  10000       0 - 6       15 - 24           Female
## 4    1   2  12000       0 - 6       25 - 44           Female
## 5    2   2  34000       0 - 6       25 - 44           Female
## 6    3   2  10000       0 - 6       25 - 44           Female
## 7    4   2  11000       0 - 6       25 - 44           Female
## 8    5   2   5000       0 - 6       25 - 44           Female
## 9    1   3  10000       0 - 6       45 - 64           Female
## 10   2   3  30000       0 - 6       45 - 64           Female
## 11   3   3   6000       0 - 6       45 - 64           Female
## 12   4   3  19000       0 - 6       45 - 64           Female
## 13   5   3   6000       0 - 6       45 - 64           Female
## 14   1   4  27000      7 - 10       15 - 24           Female
## 15   2   4 161000      7 - 10       15 - 24           Female
## 16   3   4  14000      7 - 10       15 - 24           Female
## 17   4   4  43000      7 - 10       15 - 24           Female
## 18   5   4   6000      7 - 10       15 - 24           Female
## 19   1   5 137000      7 - 10       25 - 44           Female
## 20   2   5 179000      7 - 10       25 - 44           Female
## 21   3   5  66000      7 - 10       25 - 44           Female
## 22   4   5  36000      7 - 10       25 - 44           Female
## 23   5   5  86000      7 - 10       25 - 44           Female
## 24   1   6  64000      7 - 10       45 - 64           Female
## 25   2   6 210000      7 - 10       45 - 64           Female
## 26   3   6  68000      7 - 10       45 - 64           Female
## 27   4   6  91000      7 - 10       45 - 64           Female
## 28   5   6  55000      7 - 10       45 - 64           Female
## 29   7   1  30000       0 - 6       15 - 24             Male
## 30   8   1   9000       0 - 6       15 - 24             Male
## 31   9   1  12000       0 - 6       15 - 24             Male
## 32   6   2   9000       0 - 6       25 - 44             Male
## 33   7   2  31000       0 - 6       25 - 44             Male
## 34   8   2   8000       0 - 6       25 - 44             Male
## 35   9   2  21000       0 - 6       25 - 44             Male
## 36  10   2   7000       0 - 6       25 - 44             Male
## 37   6   3   7000       0 - 6       45 - 64             Male
## 38   7   3  23000       0 - 6       45 - 64             Male
## 39   8   3   5000       0 - 6       45 - 64             Male
## 40   9   3  17000       0 - 6       45 - 64             Male
## 41  10   3   6000       0 - 6       45 - 64             Male
## 42   6   4  13000      7 - 10       15 - 24             Male
## 43   7   4 190000      7 - 10       15 - 24             Male
## 44   8   4  11000      7 - 10       15 - 24             Male
## 45   9   4  37000      7 - 10       15 - 24             Male
## 46   6   5  81000      7 - 10       25 - 44             Male
## 47   7   5 219000      7 - 10       25 - 44             Male
## 48   8   5  47000      7 - 10       25 - 44             Male
## 49   9   5  50000      7 - 10       25 - 44             Male
## 50  10   5  60000      7 - 10       25 - 44             Male
## 51   6   6  66000      7 - 10       45 - 64             Male
## 52   7   6 199000      7 - 10       45 - 64             Male
## 53   8   6  58000      7 - 10       45 - 64             Male
## 54   9   6  75000      7 - 10       45 - 64             Male
## 55  10   6  68000      7 - 10       45 - 64             Male
##          header.header.header
## 1           Bachelor&#39;s degree
## 2                 Certificate
## 3            No Qualification
## 4           Bachelor&#39;s degree
## 5                 Certificate
## 6                     Diploma
## 7            No Qualification
## 8  Postgraduate qualification
## 9           Bachelor&#39;s degree
## 10                Certificate
## 11                    Diploma
## 12           No Qualification
## 13 Postgraduate qualification
## 14          Bachelor&#39;s degree
## 15                Certificate
## 16                    Diploma
## 17           No Qualification
## 18 Postgraduate qualification
## 19          Bachelor&#39;s degree
## 20                Certificate
## 21                    Diploma
## 22           No Qualification
## 23 Postgraduate qualification
## 24          Bachelor&#39;s degree
## 25                Certificate
## 26                    Diploma
## 27           No Qualification
## 28 Postgraduate qualification
## 29                Certificate
## 30                    Diploma
## 31           No Qualification
## 32          Bachelor&#39;s degree
## 33                Certificate
## 34                    Diploma
## 35           No Qualification
## 36 Postgraduate qualification
## 37          Bachelor&#39;s degree
## 38                Certificate
## 39                    Diploma
## 40           No Qualification
## 41 Postgraduate qualification
## 42          Bachelor&#39;s degree
## 43                Certificate
## 44                    Diploma
## 45           No Qualification
## 46          Bachelor&#39;s degree
## 47                Certificate
## 48                    Diploma
## 49           No Qualification
## 50 Postgraduate qualification
## 51          Bachelor&#39;s degree
## 52                Certificate
## 53                    Diploma
## 54           No Qualification
## 55 Postgraduate qualification</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1">BELOW_RIGHT &lt;-<span class="st"> </span>data_cells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(row, col)</a></code></pre></div>
</div>
</div>
<div id="check-that-all-sheets-are-parsed-correctly-1" class="section level2">
<h2>Check that all sheets are parsed correctly</h2>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="kw">identical</span>(ABOVE_LEFT[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>], BELOW_RIGHT[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>])</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="above-left-border-example" class="section level2">
<h2>ABOVE LEFT border example</h2>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1">spreadsheet &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/purpose.xlsx&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;unpivotr&quot;</span>)</a>
<a class="sourceLine" id="cb83-2" title="2">cells &lt;-<span class="st"> </span><span class="kw">tidy_xlsx</span>(spreadsheet, <span class="st">&quot;ABOVE LEFT border&quot;</span>)<span class="op">$</span>data[[<span class="dv">1</span>]]</a></code></pre></div>
<pre><code>## Warning: &#39;tidy_xlsx()&#39; is deprecated.
## Use &#39;xlsx_cells()&#39; or &#39;xlsx_formats()&#39; instead.</code></pre>
<div id="headers-4" class="section level3">
<h3>Headers</h3>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="co"># Same as ABOVE LEFT without borders</span></a>
<a class="sourceLine" id="cb85-2" title="2">row_headers &lt;-</a>
<a class="sourceLine" id="cb85-3" title="3"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-4" title="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>, <span class="op">!</span>is_blank) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-5" title="5"><span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-6" title="6"><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)</a>
<a class="sourceLine" id="cb85-7" title="7">row_headers</a></code></pre></div>
<pre><code>## $`2`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     5     2 Female
## 2    10     2 Male  
## 
## $`3`
## # A tibble: 10 x 3
##      row   col header                    
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;                     
##  1     4     3 Bachelor&#39;s degree         
##  2     5     3 Certificate               
##  3     6     3 Diploma                   
##  4     7     3 No Qualification          
##  5     8     3 Postgraduate qualification
##  6     9     3 Bachelor&#39;s degree         
##  7    10     3 Certificate               
##  8    11     3 Diploma                   
##  9    12     3 No Qualification          
## 10    13     3 Postgraduate qualification</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1">col_headers &lt;-</a>
<a class="sourceLine" id="cb87-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb87-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>, <span class="op">!</span>is_blank) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb87-4" title="4"><span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb87-5" title="5"><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)</a>
<a class="sourceLine" id="cb87-6" title="6">col_headers</a></code></pre></div>
<pre><code>## $`2`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     2     6 0 - 6 
## 2     2     8 7 - 10
## 
## $`3`
## # A tibble: 6 x 3
##     row   col header 
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;  
## 1     3     4 15 - 24
## 2     3     5 25 - 44
## 3     3     6 45 - 64
## 4     3     7 15 - 24
## 5     3     8 25 - 44
## 6     3     9 45 - 64</code></pre>
</div>
<div id="data-4" class="section level3">
<h3>Data</h3>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="co"># Same as ABOVE LEFT without borders</span></a>
<a class="sourceLine" id="cb89-2" title="2">data_cells &lt;-</a>
<a class="sourceLine" id="cb89-3" title="3"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb89-4" title="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">4</span>, col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">4</span>, <span class="op">!</span>is_blank) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb89-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">content =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(character), numeric, <span class="ot">NA</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb89-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(content)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb89-7" title="7"><span class="st">  </span><span class="kw">select</span>(row, col, value)</a>
<a class="sourceLine" id="cb89-8" title="8">data_cells</a></code></pre></div>
<pre><code>## # A tibble: 55 x 3
##      row   col  value
##    &lt;int&gt; &lt;int&gt;  &lt;int&gt;
##  1     4     4   7000
##  2     4     5  12000
##  3     4     6  10000
##  4     4     7  27000
##  5     4     8 137000
##  6     4     9  64000
##  7     5     4  29000
##  8     5     5  34000
##  9     5     6  30000
## 10     5     7 161000
## # … with 45 more rows</code></pre>
</div>
<div id="borders" class="section level3">
<h3>Borders</h3>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="co"># Different from ABOVE LEFT without borders</span></a>
<a class="sourceLine" id="cb91-2" title="2"><span class="co"># Find cells with borders on the bottom, and ones with borders on the left</span></a>
<a class="sourceLine" id="cb91-3" title="3">formatting &lt;-<span class="st"> </span><span class="kw">tidy_xlsx</span>(spreadsheet)<span class="op">$</span>formats</a></code></pre></div>
<pre><code>## Warning: &#39;tidy_xlsx()&#39; is deprecated.
## Use &#39;xlsx_cells()&#39; or &#39;xlsx_formats()&#39; instead.</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">left_borders &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(formatting<span class="op">$</span>local<span class="op">$</span>border<span class="op">$</span>left<span class="op">$</span>style))</a>
<a class="sourceLine" id="cb93-2" title="2">top_borders &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(formatting<span class="op">$</span>local<span class="op">$</span>border<span class="op">$</span>top<span class="op">$</span>style))</a>
<a class="sourceLine" id="cb93-3" title="3"></a>
<a class="sourceLine" id="cb93-4" title="4">left_border_cells &lt;-</a>
<a class="sourceLine" id="cb93-5" title="5"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb93-6" title="6"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, local_format_id <span class="op">%in%</span><span class="st"> </span>left_borders) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb93-7" title="7"><span class="st">  </span><span class="kw">select</span>(row, col)</a>
<a class="sourceLine" id="cb93-8" title="8">top_border_cells &lt;-</a>
<a class="sourceLine" id="cb93-9" title="9"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb93-10" title="10"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(col <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, local_format_id <span class="op">%in%</span><span class="st"> </span>top_borders) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb93-11" title="11"><span class="st">  </span><span class="kw">select</span>(row, col)</a></code></pre></div>
</div>
<div id="join-headers-to-data-5" class="section level3">
<h3>Join headers to data</h3>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1">data_cells &lt;-</a>
<a class="sourceLine" id="cb94-2" title="2"><span class="st">  </span>data_cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-3" title="3"><span class="st">  </span><span class="kw">enhead</span>(col_headers[[<span class="dv">1</span>]], <span class="st">&quot;ABOVE&quot;</span>, left_border_cells) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from ABOVE LEFT</span></a>
<a class="sourceLine" id="cb94-4" title="4"><span class="st">  </span><span class="kw">enhead</span>(col_headers[[<span class="dv">2</span>]], <span class="st">&quot;N&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Same as ABOVE LEFT</span></a>
<a class="sourceLine" id="cb94-5" title="5"><span class="st">  </span><span class="kw">enhead</span>(row_headers[[<span class="dv">1</span>]], <span class="st">&quot;LEFT&quot;</span>, top_border_cells) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from ABOVE LEFT</span></a>
<a class="sourceLine" id="cb94-6" title="6"><span class="st">  </span><span class="kw">enhead</span>(row_headers[[<span class="dv">2</span>]], <span class="st">&quot;W&quot;</span>) <span class="co"># Same as ABOVE LEFT</span></a></code></pre></div>
</div>
<div id="result-6" class="section level3">
<h3>Result</h3>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1">data_cells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a></code></pre></div>
<pre><code>##    row col  value header.data header.header header.data.data
## 1    4   4   7000       0 - 6       15 - 24           Female
## 2    4   5  12000       0 - 6       25 - 44           Female
## 3    4   6  10000       0 - 6       45 - 64           Female
## 4    4   7  27000       0 - 6       15 - 24           Female
## 5    5   4  29000       0 - 6       15 - 24           Female
## 6    5   5  34000       0 - 6       25 - 44           Female
## 7    5   6  30000       0 - 6       45 - 64           Female
## 8    5   7 161000       0 - 6       15 - 24           Female
## 9    6   5  10000       0 - 6       25 - 44           Female
## 10   6   6   6000       0 - 6       45 - 64           Female
## 11   6   7  14000       0 - 6       15 - 24           Female
## 12   7   4  10000       0 - 6       15 - 24           Female
## 13   7   5  11000       0 - 6       25 - 44           Female
## 14   7   6  19000       0 - 6       45 - 64           Female
## 15   7   7  43000       0 - 6       15 - 24           Female
## 16   4   8 137000      7 - 10       25 - 44           Female
## 17   4   9  64000      7 - 10       45 - 64           Female
## 18   5   8 179000      7 - 10       25 - 44           Female
## 19   5   9 210000      7 - 10       45 - 64           Female
## 20   6   8  66000      7 - 10       25 - 44           Female
## 21   6   9  68000      7 - 10       45 - 64           Female
## 22   7   8  36000      7 - 10       25 - 44           Female
## 23   7   9  91000      7 - 10       45 - 64           Female
## 24   8   5   5000       0 - 6       25 - 44             Male
## 25   8   6   6000       0 - 6       45 - 64             Male
## 26   8   7   6000       0 - 6       15 - 24             Male
## 27   9   5   9000       0 - 6       25 - 44             Male
## 28   9   6   7000       0 - 6       45 - 64             Male
## 29   9   7  13000       0 - 6       15 - 24             Male
## 30  10   4  30000       0 - 6       15 - 24             Male
## 31  10   5  31000       0 - 6       25 - 44             Male
## 32  10   6  23000       0 - 6       45 - 64             Male
## 33  10   7 190000       0 - 6       15 - 24             Male
## 34  11   4   9000       0 - 6       15 - 24             Male
## 35  11   5   8000       0 - 6       25 - 44             Male
## 36  11   6   5000       0 - 6       45 - 64             Male
## 37  11   7  11000       0 - 6       15 - 24             Male
## 38  12   4  12000       0 - 6       15 - 24             Male
## 39  12   5  21000       0 - 6       25 - 44             Male
## 40  12   6  17000       0 - 6       45 - 64             Male
## 41  12   7  37000       0 - 6       15 - 24             Male
## 42  13   5   7000       0 - 6       25 - 44             Male
## 43  13   6   6000       0 - 6       45 - 64             Male
## 44   8   8  86000      7 - 10       25 - 44             Male
## 45   8   9  55000      7 - 10       45 - 64             Male
## 46   9   8  81000      7 - 10       25 - 44             Male
## 47   9   9  66000      7 - 10       45 - 64             Male
## 48  10   8 219000      7 - 10       25 - 44             Male
## 49  10   9 199000      7 - 10       45 - 64             Male
## 50  11   8  47000      7 - 10       25 - 44             Male
## 51  11   9  58000      7 - 10       45 - 64             Male
## 52  12   8  50000      7 - 10       25 - 44             Male
## 53  12   9  75000      7 - 10       45 - 64             Male
## 54  13   8  60000      7 - 10       25 - 44             Male
## 55  13   9  68000      7 - 10       45 - 64             Male
##          header.header.header
## 1           Bachelor&#39;s degree
## 2           Bachelor&#39;s degree
## 3           Bachelor&#39;s degree
## 4           Bachelor&#39;s degree
## 5                 Certificate
## 6                 Certificate
## 7                 Certificate
## 8                 Certificate
## 9                     Diploma
## 10                    Diploma
## 11                    Diploma
## 12           No Qualification
## 13           No Qualification
## 14           No Qualification
## 15           No Qualification
## 16          Bachelor&#39;s degree
## 17          Bachelor&#39;s degree
## 18                Certificate
## 19                Certificate
## 20                    Diploma
## 21                    Diploma
## 22           No Qualification
## 23           No Qualification
## 24 Postgraduate qualification
## 25 Postgraduate qualification
## 26 Postgraduate qualification
## 27          Bachelor&#39;s degree
## 28          Bachelor&#39;s degree
## 29          Bachelor&#39;s degree
## 30                Certificate
## 31                Certificate
## 32                Certificate
## 33                Certificate
## 34                    Diploma
## 35                    Diploma
## 36                    Diploma
## 37                    Diploma
## 38           No Qualification
## 39           No Qualification
## 40           No Qualification
## 41           No Qualification
## 42 Postgraduate qualification
## 43 Postgraduate qualification
## 44 Postgraduate qualification
## 45 Postgraduate qualification
## 46          Bachelor&#39;s degree
## 47          Bachelor&#39;s degree
## 48                Certificate
## 49                Certificate
## 50                    Diploma
## 51                    Diploma
## 52           No Qualification
## 53           No Qualification
## 54 Postgraduate qualification
## 55 Postgraduate qualification</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1">ABOVE_LEFT_borders &lt;-<span class="st"> </span>data_cells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(row, col)</a></code></pre></div>
</div>
</div>
<div id="below-right-border-example" class="section level2">
<h2>BELOW RIGHT border example</h2>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1">cells &lt;-<span class="st"> </span><span class="kw">tidy_xlsx</span>(spreadsheet, <span class="st">&quot;BELOW RIGHT border&quot;</span>)<span class="op">$</span>data[[<span class="dv">1</span>]]</a></code></pre></div>
<pre><code>## Warning: &#39;tidy_xlsx()&#39; is deprecated.
## Use &#39;xlsx_cells()&#39; or &#39;xlsx_formats()&#39; instead.</code></pre>
<div id="headers-5" class="section level3">
<h3>Headers</h3>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1"><span class="co"># Same as BELOW RIGHT without borders</span></a>
<a class="sourceLine" id="cb100-2" title="2">row_headers &lt;-</a>
<a class="sourceLine" id="cb100-3" title="3"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb100-4" title="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(col <span class="op">&gt;=</span><span class="st"> </span><span class="dv">10</span>, <span class="op">!</span>is_blank) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb100-5" title="5"><span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb100-6" title="6"><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>col)</a>
<a class="sourceLine" id="cb100-7" title="7">row_headers</a></code></pre></div>
<pre><code>## $`10`
## # A tibble: 10 x 3
##      row   col header                    
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;                     
##  1     4    10 Bachelor&#39;s degree         
##  2     5    10 Certificate               
##  3     6    10 Diploma                   
##  4     7    10 No Qualification          
##  5     8    10 Postgraduate qualification
##  6     9    10 Bachelor&#39;s degree         
##  7    10    10 Certificate               
##  8    11    10 Diploma                   
##  9    12    10 No Qualification          
## 10    13    10 Postgraduate qualification
## 
## $`11`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1     7    11 Female
## 2    10    11 Male</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1">col_headers &lt;-</a>
<a class="sourceLine" id="cb102-2" title="2"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb102-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">&gt;=</span><span class="st"> </span><span class="dv">14</span>, <span class="op">!</span>is_blank) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb102-4" title="4"><span class="st">  </span><span class="kw">select</span>(row, col, <span class="dt">header =</span> character) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb102-5" title="5"><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>row)</a>
<a class="sourceLine" id="cb102-6" title="6">col_headers</a></code></pre></div>
<pre><code>## $`14`
## # A tibble: 6 x 3
##     row   col header 
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;  
## 1    14     4 15 - 24
## 2    14     5 25 - 44
## 3    14     6 45 - 64
## 4    14     7 15 - 24
## 5    14     8 25 - 44
## 6    14     9 45 - 64
## 
## $`15`
## # A tibble: 2 x 3
##     row   col header
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
## 1    15     6 0 - 6 
## 2    15     7 7 - 10</code></pre>
</div>
<div id="data-5" class="section level3">
<h3>Data</h3>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="co"># Same as BELOW RIGHT without borders</span></a>
<a class="sourceLine" id="cb104-2" title="2">data_cells &lt;-</a>
<a class="sourceLine" id="cb104-3" title="3"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb104-4" title="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">&lt;=</span><span class="st"> </span><span class="dv">13</span>, col <span class="op">&lt;=</span><span class="st"> </span><span class="dv">9</span>, <span class="op">!</span>is_blank) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb104-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">content =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(character), numeric, <span class="ot">NA</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb104-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">as.integer</span>(content)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb104-7" title="7"><span class="st">  </span><span class="kw">select</span>(row, col, value)</a>
<a class="sourceLine" id="cb104-8" title="8">data_cells</a></code></pre></div>
<pre><code>## # A tibble: 55 x 3
##      row   col  value
##    &lt;int&gt; &lt;int&gt;  &lt;int&gt;
##  1     4     4   7000
##  2     4     5  12000
##  3     4     6  10000
##  4     4     7  27000
##  5     4     8 137000
##  6     4     9  64000
##  7     5     4  29000
##  8     5     5  34000
##  9     5     6  30000
## 10     5     7 161000
## # … with 45 more rows</code></pre>
</div>
<div id="borders-1" class="section level3">
<h3>Borders</h3>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1"><span class="co"># Different from BELOW RIGHT without borders</span></a>
<a class="sourceLine" id="cb106-2" title="2"><span class="co"># Find cells with borders on the bottom, and ones with borders on the left</span></a>
<a class="sourceLine" id="cb106-3" title="3">formatting &lt;-<span class="st"> </span><span class="kw">tidy_xlsx</span>(spreadsheet)<span class="op">$</span>formats</a></code></pre></div>
<pre><code>## Warning: &#39;tidy_xlsx()&#39; is deprecated.
## Use &#39;xlsx_cells()&#39; or &#39;xlsx_formats()&#39; instead.</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1">left_borders &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(formatting<span class="op">$</span>local<span class="op">$</span>border<span class="op">$</span>left<span class="op">$</span>style))</a>
<a class="sourceLine" id="cb108-2" title="2">top_borders &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(formatting<span class="op">$</span>local<span class="op">$</span>border<span class="op">$</span>top<span class="op">$</span>style))</a>
<a class="sourceLine" id="cb108-3" title="3"></a>
<a class="sourceLine" id="cb108-4" title="4">left_border_cells &lt;-</a>
<a class="sourceLine" id="cb108-5" title="5"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb108-6" title="6"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">==</span><span class="st"> </span><span class="dv">15</span>, local_format_id <span class="op">%in%</span><span class="st"> </span>left_borders) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb108-7" title="7"><span class="st">  </span><span class="kw">select</span>(row, col)</a>
<a class="sourceLine" id="cb108-8" title="8">top_border_cells &lt;-</a>
<a class="sourceLine" id="cb108-9" title="9"><span class="st">  </span>cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb108-10" title="10"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(col <span class="op">==</span><span class="st"> </span><span class="dv">11</span>, local_format_id <span class="op">%in%</span><span class="st"> </span>top_borders) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb108-11" title="11"><span class="st">  </span><span class="kw">select</span>(row, col)</a></code></pre></div>
</div>
<div id="join-headers-to-data-6" class="section level3">
<h3>Join headers to data</h3>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1">data_cells &lt;-</a>
<a class="sourceLine" id="cb109-2" title="2"><span class="st">  </span>data_cells <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb109-3" title="3"><span class="st">  </span><span class="kw">enhead</span>(col_headers[[<span class="dv">2</span>]], <span class="st">&quot;BELOW&quot;</span>, left_border_cells) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from BELOW RIGHT</span></a>
<a class="sourceLine" id="cb109-4" title="4"><span class="st">  </span><span class="kw">enhead</span>(col_headers[[<span class="dv">1</span>]], <span class="st">&quot;S&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Same as BELOW RIGHT</span></a>
<a class="sourceLine" id="cb109-5" title="5"><span class="st">  </span><span class="kw">enhead</span>(row_headers[[<span class="dv">2</span>]], <span class="st">&quot;RIGHT&quot;</span>, top_border_cells) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Different from BELOW RIGHT</span></a>
<a class="sourceLine" id="cb109-6" title="6"><span class="st">  </span><span class="kw">enhead</span>(row_headers[[<span class="dv">1</span>]], <span class="st">&quot;E&quot;</span>) <span class="co"># Same as BELOW RIGHT</span></a></code></pre></div>
</div>
<div id="result-7" class="section level3">
<h3>Result</h3>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1">data_cells <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a></code></pre></div>
<pre><code>##    row col  value header.data header.header header.data.data
## 1    4   4   7000       0 - 6       15 - 24           Female
## 2    4   5  12000       0 - 6       25 - 44           Female
## 3    4   6  10000       0 - 6       45 - 64           Female
## 4    5   4  29000       0 - 6       15 - 24           Female
## 5    5   5  34000       0 - 6       25 - 44           Female
## 6    5   6  30000       0 - 6       45 - 64           Female
## 7    6   5  10000       0 - 6       25 - 44           Female
## 8    6   6   6000       0 - 6       45 - 64           Female
## 9    7   4  10000       0 - 6       15 - 24           Female
## 10   7   5  11000       0 - 6       25 - 44           Female
## 11   7   6  19000       0 - 6       45 - 64           Female
## 12   8   5   5000       0 - 6       25 - 44           Female
## 13   8   6   6000       0 - 6       45 - 64           Female
## 14   4   7  27000      7 - 10       15 - 24           Female
## 15   4   8 137000      7 - 10       25 - 44           Female
## 16   4   9  64000      7 - 10       45 - 64           Female
## 17   5   7 161000      7 - 10       15 - 24           Female
## 18   5   8 179000      7 - 10       25 - 44           Female
## 19   5   9 210000      7 - 10       45 - 64           Female
## 20   6   7  14000      7 - 10       15 - 24           Female
## 21   6   8  66000      7 - 10       25 - 44           Female
## 22   6   9  68000      7 - 10       45 - 64           Female
## 23   7   7  43000      7 - 10       15 - 24           Female
## 24   7   8  36000      7 - 10       25 - 44           Female
## 25   7   9  91000      7 - 10       45 - 64           Female
## 26   8   7   6000      7 - 10       15 - 24           Female
## 27   8   8  86000      7 - 10       25 - 44           Female
## 28   8   9  55000      7 - 10       45 - 64           Female
## 29   9   5   9000       0 - 6       25 - 44             Male
## 30   9   6   7000       0 - 6       45 - 64             Male
## 31  10   4  30000       0 - 6       15 - 24             Male
## 32  10   5  31000       0 - 6       25 - 44             Male
## 33  10   6  23000       0 - 6       45 - 64             Male
## 34  11   4   9000       0 - 6       15 - 24             Male
## 35  11   5   8000       0 - 6       25 - 44             Male
## 36  11   6   5000       0 - 6       45 - 64             Male
## 37  12   4  12000       0 - 6       15 - 24             Male
## 38  12   5  21000       0 - 6       25 - 44             Male
## 39  12   6  17000       0 - 6       45 - 64             Male
## 40  13   5   7000       0 - 6       25 - 44             Male
## 41  13   6   6000       0 - 6       45 - 64             Male
## 42   9   7  13000      7 - 10       15 - 24             Male
## 43   9   8  81000      7 - 10       25 - 44             Male
## 44   9   9  66000      7 - 10       45 - 64             Male
## 45  10   7 190000      7 - 10       15 - 24             Male
## 46  10   8 219000      7 - 10       25 - 44             Male
## 47  10   9 199000      7 - 10       45 - 64             Male
## 48  11   7  11000      7 - 10       15 - 24             Male
## 49  11   8  47000      7 - 10       25 - 44             Male
## 50  11   9  58000      7 - 10       45 - 64             Male
## 51  12   7  37000      7 - 10       15 - 24             Male
## 52  12   8  50000      7 - 10       25 - 44             Male
## 53  12   9  75000      7 - 10       45 - 64             Male
## 54  13   8  60000      7 - 10       25 - 44             Male
## 55  13   9  68000      7 - 10       45 - 64             Male
##          header.header.header
## 1           Bachelor&#39;s degree
## 2           Bachelor&#39;s degree
## 3           Bachelor&#39;s degree
## 4                 Certificate
## 5                 Certificate
## 6                 Certificate
## 7                     Diploma
## 8                     Diploma
## 9            No Qualification
## 10           No Qualification
## 11           No Qualification
## 12 Postgraduate qualification
## 13 Postgraduate qualification
## 14          Bachelor&#39;s degree
## 15          Bachelor&#39;s degree
## 16          Bachelor&#39;s degree
## 17                Certificate
## 18                Certificate
## 19                Certificate
## 20                    Diploma
## 21                    Diploma
## 22                    Diploma
## 23           No Qualification
## 24           No Qualification
## 25           No Qualification
## 26 Postgraduate qualification
## 27 Postgraduate qualification
## 28 Postgraduate qualification
## 29          Bachelor&#39;s degree
## 30          Bachelor&#39;s degree
## 31                Certificate
## 32                Certificate
## 33                Certificate
## 34                    Diploma
## 35                    Diploma
## 36                    Diploma
## 37           No Qualification
## 38           No Qualification
## 39           No Qualification
## 40 Postgraduate qualification
## 41 Postgraduate qualification
## 42          Bachelor&#39;s degree
## 43          Bachelor&#39;s degree
## 44          Bachelor&#39;s degree
## 45                Certificate
## 46                Certificate
## 47                Certificate
## 48                    Diploma
## 49                    Diploma
## 50                    Diploma
## 51           No Qualification
## 52           No Qualification
## 53           No Qualification
## 54 Postgraduate qualification
## 55 Postgraduate qualification</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1">BELOW_RIGHT_borders &lt;-<span class="st"> </span>data_cells <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(row, col)</a></code></pre></div>
</div>
</div>
<div id="check-that-all-sheets-are-parsed-correctly-2" class="section level2">
<h2>Check that all sheets are parsed correctly</h2>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"><span class="kw">identical</span>(ABOVE_LEFT[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>], BELOW_RIGHT[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>])</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="kw">identical</span>(ABOVE_LEFT[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>], ABOVE_LEFT_borders[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>])</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="kw">identical</span>(ABOVE_LEFT[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>], BELOW_RIGHT_borders[, <span class="dv">-1</span><span class="op">:-</span><span class="dv">2</span>])</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
